function DLOG(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(null,e)}function DWARN(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(null,e)}function DERR(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.error.apply(null,e)}function DEBUGME(e){return(debugSwitcher&e)>0}var __reflect=this&&this.__reflect||function(e,t,o){e.__class__=t,o?o.push(t):o=[t],e.__types__=e.__types__?o.concat(e.__types__):o},__extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);o.prototype=t.prototype,e.prototype=new o},__awaiter=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(s,a){function n(e){try{c(i.next(e))}catch(t){a(t)}}function r(e){try{c(i["throw"](e))}catch(t){a(t)}}function c(e){e.done?s(e.value):new o(function(t){t(e.value)}).then(n,r)}c((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function o(e){return function(t){return i([e,t])}}function i(o){if(s)throw new TypeError("Generator is already executing.");for(;c;)try{if(s=1,a&&(n=a[2&o[0]?"return":o[0]?"throw":"next"])&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[0,n.value]),o[0]){case 0:case 1:n=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,a=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(n=c.trys,!(n=n.length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){c=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){c.label=o[1];break}if(6===o[0]&&c.label<n[1]){c.label=n[1],n=o;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(o);break}n[2]&&c.ops.pop(),c.trys.pop();continue}o=t.call(e,c)}catch(i){o=[6,i],a=0}finally{s=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var s,a,n,r,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},ui_road_def=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(eui.Component);__reflect(ui_road_def.prototype,"ui_road_def",["eui.UIComponent","egret.DisplayObject"]);var NotifyName=function(){function e(){}return e.car_moving="car_moving",e.car_eated="car_eated",e.car_speed_slowdown="car_speed_slowdown",e.car_hp_change="car_hp_change",e.board_closed="board_closed",e.game_end="game_end",e.game_revivo="game_revivo",e.display_index="display_index",e.display_game="display_game",e.display_rank="display_rank",e.display_bonus="display_bonus",e}();__reflect(NotifyName.prototype,"NotifyName");var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return o.sent(),[4,this.loadTheme()];case 2:return o.sent(),[4,RES.loadGroup("preload",0,e)];case 3:return o.sent(),this.stage.removeChild(e),[3,5];case 4:return t=o.sent(),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,o){var i=new eui.Theme("resource/default.thm.json",e.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){Conf.One.reset(this.stage),egret.Ticker.getInstance().register(function(e){dragonBones.WorldClock.clock.advanceTime(e/1e3)},this);var e=new ui_road;this.addChild(e)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,o,i){function s(e){t.call(i,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),o.call(i))}var n=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(i,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,o){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(i,generateEUI2)},n)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var r=e.split("/");r.pop();var c=r.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(i,generateJSON.paths[e])},this):RES.getResByUrl(c,function(o){window.JSONParseClass.setData(o),egret.callLater(function(){t.call(i,generateJSON.paths[e])},n)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(i,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,s,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Conf=function(){function e(){this.is_game_end=!1,this.info_ph=0,this.info_km_pos={x:0,y:0},this.info_is_addedlife=!1,this.Coin_Collect_Total=0,this.Revivo_Times=0,this.range_car_move=new egret.Rectangle(100,0,0,0),this.coin_rand_pot=0,this.coin_pot_cur=0,this.coin_pots=[]}return e.prototype.reset=function(e){this.is_game_end=!1,this.info_ph=460,this.Coin_Collect_Total=0,this.Revivo_Times=1,this.STAGE=e,this.range_car_move.width=this.STAGE.stageWidth-this.range_car_move.x,this.info_is_addedlife=!1;for(var t=9,o=this.STAGE.stageWidth/(t-1),i=30,s=0;t>s;s++)this.coin_pots.push(s*o+i)},e.prototype.hp_reduce=function(e){return this.info_ph-=e,this.info_ph<=0&&(this.info_ph=0,this.is_game_end=!0,Notify.One().post(NotifyName.game_end)),this.info_ph},e.prototype.coin_rand=function(){for(var e=this.coin_pot_cur,t=0;5>t;t++)e==this.coin_pot_cur&&(this.coin_pot_cur=Math.floor(Math.random()*this.coin_pots.length));return this.coin_rand_pot=this.coin_pots[this.coin_pot_cur],this.coin_rand_pot},e.prototype.anm_load=function(e,t){void 0===t&&(t=0);var o=RES.getRes("anm1_ske_json"),i=RES.getRes("anm1_tex_png"),s=RES.getRes("anm1_tex_json"),a=new dragonBones.EgretFactory;a.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(o)),a.addTextureAtlas(new dragonBones.EgretTextureAtlas(i,s));var n;switch(e){case AnimationName.coin:n=a.buildArmatureDisplay("anm1"),n.animation.gotoAndPlayByTime("coin",t);break;case AnimationName.globalPlanet:n=a.buildArmatureDisplay("anm1"),n.animation.play("planet",1);break;case AnimationName.plane1:n=a.buildArmatureDisplay("plane1_fly"),n.animation.play("newAnimation",1);break;case AnimationName.plane2:n=a.buildArmatureDisplay("plane2_fly"),n.animation.play("newAnimation",1);break;case AnimationName.whale:n=a.buildArmatureDisplay("anm1"),n.animation.play("whale",1)}return n},e.prototype.res_load=function(e){var t=null;switch(e){case ItemType.chest_red_clearly:t=RES.getRes("res01_json.chest_red");break;case ItemType.chest_green_addHp:t=RES.getRes("res01_json.chest_green");break;case ItemType.chest_yellow_speedon_invincible:t=RES.getRes("res01_json.chest_yellow");break;case ItemType.chest_orange_easyGetChest:t=RES.getRes("res01_json.chest_orange");break;case ItemType.chest_blue_all_effect:t=RES.getRes("res01_json.chest_blue");break;case ItemType.chest_purple_secret:t=RES.getRes("res01_json.chest_purple");break;case ItemType.chest_tree:t=RES.getRes("res01_json.chest_tree");break;case ItemType.chest_girl:t=RES.getRes("res01_json.chest_girl");break;case ItemType.hole1:t=RES.getRes("res01_json.hole_1");break;case ItemType.well1:t=RES.getRes("res01_json.well_1");break;case ItemType.water1:t=RES.getRes("res01_json.water_1");break;case ItemType.pop_blue:t=RES.getRes("res01_json.pop_blue");break;case ItemType.pop_red:t=RES.getRes("res01_json.pop_red");break;case ItemType.pop_green:t=RES.getRes("res01_json.pop_green");break;case ItemType.pop_yellow:t=RES.getRes("res01_json.pop_yellow");break;case ItemType.pop_orange:t=RES.getRes("res01_json.pop_orange");break;case ItemType.pop_purple:t=RES.getRes("res01_json.pop_purple");break;case ItemType.pop_tree:t=RES.getRes("res01_json.pop_tree");break;case ItemType.pop_girl:t=RES.getRes("res01_json.pop_girl");break;case ItemType.glassRoad:t=RES.getRes("res01_json.glass_1");break;case ItemType.cloud:var o=["res01_json.cloud_1","res01_json.cloud_2","res01_json.cloud_3"];t=RES.getRes(o[Math.floor(Math.random()*o.length)])}return t},e.prototype.hitRect=function(e,t){if(e.contains(t.topLeft.x,t.topLeft.y)||e.contains(t.topLeft.x+t.width,t.topLeft.y)||e.contains(t.topLeft.x,t.topLeft.y+t.height)||e.contains(t.topLeft.x+t.width,t.topLeft.y+t.height))return!0;var o=t;return t=e,e=o,e.contains(t.topLeft.x,t.topLeft.y)||e.contains(t.topLeft.x+t.width,t.topLeft.y)||e.contains(t.topLeft.x,t.topLeft.y+t.height)||e.contains(t.topLeft.x+t.width,t.topLeft.y+t.height)?!0:!1},e.prototype.set_color=function(e,t){var o=function(e){var t={r:0,g:0,b:0};return t.b=e%256,t.g=Math.floor(e/256)%256,t.r=Math.floor(e/256/256),t},i=o(t),s=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];s[0]=i.r/255,s[6]=i.g/255,s[12]=i.b/255;var a=new egret.ColorMatrixFilter(s);e.filters=[a]},Object.defineProperty(e,"One",{get:function(){return this._s?this._s:(this._s=new e,this._s)},enumerable:!0,configurable:!0}),e}();__reflect(Conf.prototype,"Conf");var Notify=function(){function e(){this.dicNtfs={},DLOG("Notify::Init")}return e.One=function(){return null==this.__single&&(this.__single=new e),this.__single},e.prototype.post=function(e,t){if(void 0===t&&(t=null),null==this.dicNtfs[e])return void DLOG("Notify::Post::"+e);for(var o=this.dicNtfs[e],i=0;i<o.length;i++)o[i].post(t)},e.prototype.add=function(e,t,o){if(null!=o&&null!=t){null==this.dicNtfs[e]&&(this.dicNtfs[e]=[]);for(var i in this.dicNtfs[e])if(this.dicNtfs[e].hasOwnProperty(i)&&this.dicNtfs[e][i].target==o)return void DWARN("Notify::Add::Repeat::"+e);var s=new NotifyObserve(e,o,t);this.dicNtfs[e].push(s)}},e.prototype.clear=function(){DLOG("Notify::Clear");for(var e in this.dicNtfs)for(var t=this.dicNtfs[e],o=t.length-1;o>=0;o--)t[o].clear();this.dicNtfs={}},e.prototype.removeName=function(e){DLOG("Notify::Remove::"+e);for(var t in this.dicNtfs)if(e==t){for(var o=this.dicNtfs[t],i=o.length-1;i>=0;i--)o[i].clear();this.dicNtfs[t]=null,delete this.dicNtfs[t]}},e.prototype.removeTarget=function(e){DLOG("Notify::Remove::"+e);for(var t in this.dicNtfs)for(var o=this.dicNtfs[t],i=o.length-1;i>=0;i--)o[i].target==e&&(o[i].clear(),o.splice(i,1))},e}();__reflect(Notify.prototype,"Notify");var NotifyObserve=function(){function e(e,t,o){this.target=t,this.name=e,this.func=o}return e.prototype.post=function(e){this.userdata=e,this.func.call(this.target,this)},e.prototype.clear=function(){this.target=null,this.name=null,this.func=null,this.userdata=null},e}();__reflect(NotifyObserve.prototype,"NotifyObserve");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var DM;!function(e){e[e.debug=1]="debug",e[e.demo=2]="demo",e[e.release=4]="release"}(DM||(DM={}));var DS;!function(e){e[e.NONE=0]="NONE",e[e.car_clearly_first=1]="car_clearly_first",e[e.debug_draw_area=2]="debug_draw_area",e[e.debug_button_group=4]="debug_button_group",e[e.able_eat_coin=8]="able_eat_coin",e[e.cloudy_motion1=16]="cloudy_motion1",e[e.cloudy_motion2=32]="cloudy_motion2",e[e.car_rotation=64]="car_rotation"}(DS||(DS={}));var debugMode=DM.release;debugMode=0|DM.debug,debugMode=0|DM.demo;var debugSwitcher=DS.NONE;switch(debugMode){case DM.debug:debugSwitcher=DS.debug_button_group|DS.cloudy_motion2|DS.car_rotation;break;case DM.demo:debugSwitcher=DS.debug_button_group|DS.cloudy_motion2|DS.car_rotation;break;case DM.release:default:debugSwitcher=DS.NONE|DS.cloudy_motion2|DS.car_rotation}var ItemType;!function(e){e[e.chest_red_clearly=0]="chest_red_clearly",e[e.chest_green_addHp=1]="chest_green_addHp",e[e.chest_orange_easyGetChest=2]="chest_orange_easyGetChest",e[e.chest_yellow_speedon_invincible=3]="chest_yellow_speedon_invincible",e[e.chest_blue_all_effect=4]="chest_blue_all_effect",e[e.chest_purple_secret=5]="chest_purple_secret",e[e.chest_tree=6]="chest_tree",e[e.chest_girl=7]="chest_girl",e[e.hole1=8]="hole1",e[e.well1=9]="well1",e[e.water1=10]="water1",e[e.coin=11]="coin",e[e.plane1=12]="plane1",e[e.plane2=13]="plane2",e[e.globalPlanet=14]="globalPlanet",e[e.whale=15]="whale",e[e.pop_blue=16]="pop_blue",e[e.pop_green=17]="pop_green",e[e.pop_yellow=18]="pop_yellow",e[e.pop_red=19]="pop_red",e[e.pop_orange=20]="pop_orange",e[e.pop_purple=21]="pop_purple",e[e.pop_tree=22]="pop_tree",e[e.pop_girl=23]="pop_girl",e[e.glassRoad=24]="glassRoad",e[e.cloud=25]="cloud"}(ItemType||(ItemType={}));var ItemPosition;!function(e){e[e.NONE=0]="NONE",e[e.left=1]="left",e[e.lm_center=2]="lm_center",e[e.middle=3]="middle",e[e.mr_center=4]="mr_center",e[e.right=5]="right",e[e.top_down_randomV=6]="top_down_randomV",e[e.pot_random=7]="pot_random",e[e.pot3_random=8]="pot3_random",e[e.pot2middle_random=9]="pot2middle_random",e[e.ship_leftToRight=10]="ship_leftToRight",e[e.ship_rightToLeft=11]="ship_rightToLeft",e[e.globalPlanet=12]="globalPlanet",e[e.whalePot=13]="whalePot",e[e.popScale=14]="popScale",e[e.glassRoad=15]="glassRoad",e[e.cloud_random=16]="cloud_random",e[e.cloudPos_left=17]="cloudPos_left",e[e.cloudPos_right=18]="cloudPos_right"}(ItemPosition||(ItemPosition={}));var AnimationName;!function(e){e[e.coin=0]="coin",e[e.plane1=1]="plane1",e[e.plane2=2]="plane2",e[e.globalPlanet=3]="globalPlanet",e[e.whale=4]="whale"}(AnimationName||(AnimationName={}));var CarStatus;!function(e){e[e.NONE=0]="NONE",e[e.water=1]="water",e[e.invincible=2]="invincible"}(CarStatus||(CarStatus={}));var board_end=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/ui/board_end.exml",t}return __extends(t,e),t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t.prototype.killMe=function(){this.parent&&this.parent.removeChild(this),Notify.One().post(NotifyName.board_closed)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);for(var t=[this.bt_close,this.bt_rank,this.bt_revivo,this.bt_bonus],o=0;o<t.length;o++)t[o].alpha=0;this.bt_close.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this),this.bt_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this),this.bt_bonus.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this),this.bt_revivo.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this)},t}(eui.Component);__reflect(board_end.prototype,"board_end",["eui.UIComponent","egret.DisplayObject"]);var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,o){function i(i){t.call(o,i,e)}if(RES.hasRes(e)){var s=RES.getRes(e);s?i(s):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ui_road=function(e){function t(){var t=e.call(this)||this;return t.status=CarStatus.NONE,t.p_old={x:0,y:0},t.p_down=0,t.p_car={x:0,y:0},t.p_threshold=20,t.is_car_turning=!1,t.cloudy_tw=null,t.glass_cur=0,t.count_clearly=100,t.skinName="resource/ui/ui_road.exml",Notify.One().add(NotifyName.car_eated,t.onNtf,t),Notify.One().add(NotifyName.car_hp_change,t.onNtf,t),Notify.One().add(NotifyName.car_speed_slowdown,t.onNtf,t),Notify.One().add(NotifyName.game_end,t.onNtf,t),Notify.One().add(NotifyName.board_closed,t.onNtf,t),t}return __extends(t,e),t.prototype.reset=function(){var e=this;this.txt_hp.text=Conf.One.info_ph.toString(),this.ly_txtCoinCount.visible=!1,this.txtCoinCount.text="0",this.ly_blocks.visible=!1,this.mcDetectTarget.alpha=0,this.road_masker.alpha=0,this.ly_pop_km.visible=!1,this.ly_board.visible=!1,Conf.One.info_km_pos={x:this.ly_pop_km.horizontalCenter,y:this.ly_pop_km.bottom},DEBUGME(DS.cloudy_motion1)?(this.mov_cloudy.play(2e5*Math.random()),this.mov_cloudy.addEventListener("complete",this.onTweenGroupComplete,this)):this.ly_cloudy.visible=!1,DEBUGME(DS.cloudy_motion2)&&this.create_cloudy_motion(),DEBUGME(DS.debug_draw_area)&&(this.mcDetectTarget.alpha=1),DEBUGME(DS.car_clearly_first)&&this.car_clearly(!0),DEBUGME(DS.debug_button_group)?(this.bt_d_coin.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.create_more_coins(3)},this),this.bt_d_ship.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.create_shipWar()},this),this.bt_d_whale.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.create_whale()},this),this.bt_d_hole.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.create_trap(ItemType.hole1)},this),this.bt_d_well.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.create_trap(ItemType.well1)},this),this.bt_d_water.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.create_trap(ItemType.water1)},this),this.bt_d_chest1red.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.create_chest(ItemType.chest_red_clearly)},this),this.bt_d_popboard.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.create_popInfo(ItemType.pop_red)},this),this.bt_d_glassroad.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.create_glassRound()},this),this.bt_d_infokm.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.create_info_km(-1e3)},this),this.bt_d_gameover.addEventListener(egret.TouchEvent.TOUCH_END,function(){Notify.One().post(NotifyName.game_end)},this)):this.ly_debug_btns.visible=!1},t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.reset(),this.mov_road_def.play(0),this.mov_road_def.addEventListener("complete",this.onTweenGroupComplete,this),this.mov_car1.addEventListener("complete",this.onTweenGroupComplete,this),this.mov_car2.addEventListener("complete",this.onTweenGroupComplete,this),this.addEventListener("touchBegin",this.onTBegin,this),this.addEventListener("touchMove",this.onTMove,this),this.addEventListener("touchEnd",this.onTEnd,this)},t.prototype.create_cloudy_motion=function(){null==this.cloudy_tw&&(this.cloudy_tw=new egret.Sprite,this.ly_pots.addChild(this.cloudy_tw)),egret.Tween.get(this.cloudy_tw,{loop:!0}).wait(200).call(this.create_cloudy_motion_real,this)},t.prototype.stop_cloudy=function(){egret.Tween.removeTweens(this.cloudy_tw);for(var e=this.cloudy_tw.numChildren-1;e>=0;e--)this.cloudy_tw.getChildAt(e).stopMe()},t.prototype.create_cloudy_motion_real=function(){Math.random()<.5||this.motion_chest(ItemType.cloud,ItemPosition.cloud_random)},t.prototype.create_info_km=function(e){Notify.One().post(NotifyName.car_speed_slowdown),this.ly_pop_km.visible=!0,this.ly_pop_km.alpha=1,egret.Tween.removeTweens(this.ly_pop_km),this.txt_pop_km.text=e.toString(),0>e?Conf.One.set_color(this.ly_pop_km,13113111):Conf.One.set_color(this.ly_pop_km,65328),this.ly_pop_km.bottom=Conf.One.info_km_pos.y;var t=100,o=egret.Tween.get(this.ly_pop_km).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(500).call(function(){Notify.One().post(NotifyName.car_hp_change,{value:e})}).to({bottom:Conf.One.info_km_pos.y+20,alpha:0},1e3);o.timeScale=2},t.prototype.create_whale=function(){this.motion_chest(ItemType.whale,ItemPosition.whalePot)},t.prototype.create_shipWar=function(){var e=this;this.motion_chest(ItemType.globalPlanet,ItemPosition.globalPlanet),egret.Tween.get(this).wait(500).call(function(){e.motion_chest(ItemType.plane2,ItemPosition.ship_rightToLeft)}).wait(200).call(function(){e.motion_chest(ItemType.plane1,ItemPosition.ship_leftToRight)})},t.prototype.create_visionBlock=function(){this.ly_blocks.visible=!0,this.ly_blocks.alpha=0,egret.Tween.get(this.ly_blocks).to({alpha:1},800).wait(2e3).to({alpha:0},500).set({visible:!1})},t.prototype.create_trap=function(e){switch(e){case ItemType.well1:this.motion_chest(e,ItemPosition.pot3_random);break;default:this.motion_chest(e,ItemPosition.pot2middle_random)}Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget})},t.prototype.create_chest=function(e){this.motion_chest(e,ItemPosition.pot3_random),Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget})},t.prototype.create_popInfo=function(e){this.motion_chest(e,ItemPosition.popScale)},t.prototype.create_glassRound=function(e){void 0===e&&(e=12),this.glass_cur=e,null==this.glass_tw_obj&&(this.glass_tw_obj=new egret.Sprite,this.addChild(this.glass_tw_obj)),egret.Tween.get(this.glass_tw_obj,{loop:!0}).wait(300).call(this.create_glass_road_real,this)},t.prototype.create_glass_road_real=function(){this.glass_cur>0?(this.glass_cur--,this.motion_chest(ItemType.glassRoad,ItemPosition.glassRoad)):egret.Tween.removeTweens(this.glass_tw_obj)},t.prototype.create_more_coins=function(e){egret.Tween.get(this,{onChange:this.create_more_coins_real,onChangeObj:this}).wait(200).to({a:1},1e3*e)},t.prototype.create_more_coins_real=function(){Math.random()<.6||(this.motion_chest(ItemType.coin,ItemPosition.top_down_randomV),Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget}))},t.prototype.car_toClearly=function(){var e=this,t=50;egret.Tween.get(this.car).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).call(function(){e.car_clearly(!0)},this).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t)},t.prototype.car_clearly=function(e){e?this.car.source="res01_json.car":this.car.source="res01_json.car_masaka"},t.prototype.motion_chest=function(e,t,o){void 0===o&&(o=1);var i={x:0,y:0,scaleX:1},s={x:0,y:0,scaleX:1};if(t==ItemPosition.pot3_random){var a=[ItemPosition.left,ItemPosition.middle,ItemPosition.right];t=a[Math.floor(Math.random()*a.length)]}else if(t==ItemPosition.pot2middle_random){var n=[ItemPosition.lm_center,ItemPosition.mr_center];t=n[Math.floor(Math.random()*n.length)]}else if(t==ItemPosition.cloud_random){var r=[ItemPosition.cloudPos_left,ItemPosition.cloudPos_right];t=r[Math.floor(Math.random()*r.length)]}switch(t){case ItemPosition.left:i.x=this.p_start1.x,i.y=this.stage.stageHeight-this.p_start1.bottom,i.scaleX=this.p_start1.scaleX;break;case ItemPosition.lm_center:i.x=(this.p_start1.x+this.p_start2.x)/2,i.y=this.stage.stageHeight-this.p_start1.bottom,i.scaleX=this.p_start1.scaleX;break;case ItemPosition.middle:i.x=this.p_start2.x,i.y=this.stage.stageHeight-this.p_start2.bottom,i.scaleX=this.p_start2.scaleX;break;case ItemPosition.mr_center:i.x=(this.p_start2.x+this.p_start3.x)/2,i.y=this.stage.stageHeight-this.p_start3.bottom,i.scaleX=this.p_start3.scaleX;break;case ItemPosition.right:i.x=this.p_start3.x,i.y=this.stage.stageHeight-this.p_start3.bottom,i.scaleX=this.p_start3.scaleX;break;case ItemPosition.top_down_randomV:Conf.One.coin_rand(),i.x=Conf.One.coin_rand_pot,i.y=0,i.scaleX=1;break;case ItemPosition.ship_leftToRight:i.x=this.p_start4.x,i.y=this.p_start4.top,i.scaleX=this.p_start4.scaleX;break;case ItemPosition.ship_rightToLeft:i.x=this.p_start5.x,i.y=this.p_start5.top,i.scaleX=this.p_start5.scaleX;break;case ItemPosition.whalePot:i.x=this.p_start6.x,i.y=this.stage.stageHeight-this.p_start6.bottom,i.scaleX=this.p_start6.scaleX;break;case ItemPosition.globalPlanet:i.x=this.p_start2.x,i.y=this.stage.stageHeight-this.p_start2.bottom,i.scaleX=this.p_start2.scaleX;break;case ItemPosition.popScale:i.x=this.stage.stageWidth/2,i.y=this.ly_popboard.height/2,i.scaleX=0;break;case ItemPosition.glassRoad:i.x=this.p_start2.x,i.y=this.stage.stageHeight-this.p_start2.bottom,i.scaleX=1;break;case ItemPosition.cloudPos_left:i.x=this.p_start1.x,i.y=this.stage.stageHeight-this.p_start1.bottom-50,i.scaleX=0;break;case ItemPosition.cloudPos_right:i.x=this.p_start3.x,i.y=this.stage.stageHeight-this.p_start3.bottom-50,i.scaleX=0}switch(t){case ItemPosition.left:s.x=this.p_end1.x,s.y=this.stage.stageHeight-this.p_end1.bottom,s.scaleX=this.p_end1.scaleX;break;case ItemPosition.lm_center:s.x=this.p_end2.x,s.y=this.stage.stageHeight-this.p_end2.bottom,s.scaleX=this.p_end2.scaleX;break;case ItemPosition.middle:s.x=this.p_end3.x,s.y=this.stage.stageHeight-this.p_end3.bottom,s.scaleX=this.p_end3.scaleX;break;case ItemPosition.mr_center:s.x=this.p_end4.x,s.y=this.stage.stageHeight-this.p_end4.bottom,s.scaleX=this.p_end4.scaleX;break;case ItemPosition.right:s.x=this.p_end5.x,s.y=this.stage.stageHeight-this.p_end5.bottom,s.scaleX=this.p_end5.scaleX;break;case ItemPosition.top_down_randomV:s.x=i.x,s.y=this.ly_pots.height,s.scaleX=1;break;case ItemPosition.ship_leftToRight:s=i;break;case ItemPosition.ship_rightToLeft:s=i;break;case ItemPosition.whalePot:s=i;break;case ItemPosition.popScale:s.scaleX=2;break;case ItemPosition.glassRoad:s.x=this.p_end3.x,s.y=1.5*this.stage.stageHeight-this.p_end3.bottom,s.scaleX=this.p_end5.scaleX;break;case ItemPosition.cloudPos_left:s.x=i.x-4*this.stage.stageWidth,s.y=i.y+(Math.random()-.5)*this.stage.stageHeight*5,s.scaleX=this.p_end1.scaleX;break;case ItemPosition.cloudPos_right:s.x=i.x+4*this.stage.stageWidth,s.y=i.y+(Math.random()-.5)*this.stage.stageHeight*5,s.scaleX=this.p_end1.scaleX;break;case ItemPosition.globalPlanet:default:s=i}var c=(new Item).reset(e);switch(t==ItemPosition.popScale&&(s.x=(this.stage.stageWidth-c.width*s.scaleX)/2,s.y=(this.ly_popboard.height-c.height*s.scaleX)/2),e){case ItemType.glassRoad:this.ly_pots_trap.addChild(c);var l=new eui.Image("res01_json.road_bg");this.addChild(l),l.alpha=1,l.horizontalCenter=this.road_masker.horizontalCenter,l.bottom=this.road_masker.bottom,l.width=this.road_masker.width,l.height=this.road_masker.height,c.mask=l;break;case ItemType.globalPlanet:case ItemType.whale:this.ly_pots_planet.addChild(c);break;case ItemType.well1:case ItemType.water1:case ItemType.hole1:this.ly_pots_trap.addChild(c);break;case ItemType.pop_blue:case ItemType.pop_green:case ItemType.pop_yellow:case ItemType.pop_orange:case ItemType.pop_red:case ItemType.pop_purple:case ItemType.pop_tree:case ItemType.pop_girl:this.ly_popboard.addChild(c);break;case ItemType.cloud:DEBUGME(DS.cloudy_motion2)&&this.cloudy_tw.addChild(c);break;default:this.ly_pots.addChild(c)}t!=ItemPosition.NONE&&c.motion(i,s,o)},t.prototype.onTBegin=function(e){Conf.One.is_game_end||(this.p_down=1,this.p_old.x=e.stageX,this.p_old.y=e.stageY,this.p_car.x=this.ly_car.x,this.p_car.y=this.ly_car.y)},t.prototype.onTMove=function(e){if(!Conf.One.is_game_end&&this.p_down>0){this.p_down=2;var t=e.stageX-this.p_old.x;this.is_car_turning||(t>this.p_threshold?this.is_car_turning=!0:t<-this.p_threshold&&(this.is_car_turning=!0)),DEBUGME(DS.car_rotation)&&(this.car.rotation=-(this.ly_car.x-this.stage.stageWidth/2)/50),this.p_car.x+t/.5<Conf.One.range_car_move.x?this.ly_car.x=Conf.One.range_car_move.x:this.p_car.x+t/.5>Conf.One.range_car_move.width?this.ly_car.x=Conf.One.range_car_move.width:this.ly_car.x=this.p_car.x+t/.5,Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget})}},t.prototype.onTEnd=function(e){this.p_down=0},t.prototype.onTweenGroupComplete=function(e){switch(e.target){case this.mov_road_def:e.target.play(0);break;case this.mov_cloudy:e.target.play(0);break;default:this.is_car_turning=!1}},t.prototype.game_end=function(){Conf.One.is_game_end=!0,this.mov_road_def.stop(),this.stop_cloudy();var e=new board_end;this.ly_board.addChild(e),this.ly_board.visible=!0},t.prototype.onNtf=function(e){switch(e.name){case NotifyName.car_eated:switch(e.userdata.type){case ItemType.hole1:case ItemType.well1:this.create_info_km(-60);break;case ItemType.water1:this.status!=CarStatus.invincible&&this.create_visionBlock();break;case ItemType.coin:Conf.One.Coin_Collect_Total++,egret.Tween.removeTweens(this.ly_txtCoinCount),this.ly_txtCoinCount.visible=!0,egret.Tween.get(this.ly_txtCoinCount).wait(1e3).set({visible:!1}),this.txtCoinCount.text=Conf.One.Coin_Collect_Total.toString();break;case ItemType.chest_red_clearly:this.car_toClearly()}break;case NotifyName.car_hp_change:Conf.One.hp_reduce(Math.abs(e.userdata.value)),this.txt_hp.text=Conf.One.info_ph.toString();break;case NotifyName.car_speed_slowdown:egret.Tween.TIMESCALE=.3,setInterval(function(){egret.Tween.TIMESCALE=1},800);break;case NotifyName.game_end:this.game_end();break;case NotifyName.board_closed:this.ly_board.visible=!1}},t}(ui_road_def);__reflect(ui_road.prototype,"ui_road");var ui_test=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/ui/ui_test.exml",t}return __extends(t,e),t.prototype.partAdded=function(t,o){e.prototype.partAdded.call(this,t,o)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.motion_chest(ItemType.chest_red_clearly,ItemPosition.left)},t.prototype.motion_chest=function(e,t){var o=null;switch(e){case ItemType.chest_red_clearly:o=RES.getRes("res01_json.chest_red");break;default:o=RES.getRes("res01_json.chest_red")}var i=new egret.Bitmap(o);this.addChild(i)},t}(eui.Component);__reflect(ui_test.prototype,"ui_test",["eui.UIComponent","egret.DisplayObject"]);var Item=function(e){function t(){var t=e.call(this)||this;return t.isAnimation=!1,t.isDetected=!1,t}return __extends(t,e),t.prototype.reset=function(e,t){void 0===t&&(t=100),this.isAnimation=!1,this.type=e;var o=null;switch(this.name="Item_"+e.toString(),e){case ItemType.coin:this.anm=Conf.One.anm_load(AnimationName.coin,200*Math.random()),this.isAnimation=!0,this.anm.rotation=100*Math.random()-50;break;case ItemType.plane1:this.anm=Conf.One.anm_load(AnimationName.plane1),this.isAnimation=!0;break;case ItemType.plane2:this.anm=Conf.One.anm_load(AnimationName.plane2),this.isAnimation=!0;break;case ItemType.globalPlanet:this.anm=Conf.One.anm_load(AnimationName.globalPlanet),this.isAnimation=!0;break;case ItemType.whale:this.anm=Conf.One.anm_load(AnimationName.whale),this.isAnimation=!0;break;default:o=Conf.One.res_load(e),null==o&&console.warn("error type:"+e)}return this.isAnimation?this.addChild(this.anm):(this.img=new egret.Bitmap,this.addChild(this.img),this.img.texture=o),this},t.prototype.motion=function(e,t,o){void 0===o&&(o=1);var i=this.isAnimation?this.anm:this.img,s=5e3,a=o;switch(this.type){case ItemType.plane1:case ItemType.plane2:a=2;break;case ItemType.globalPlanet:a=2,s=5e4;break;case ItemType.coin:a=1,s=3e3,this.isDetected=!0;break;case ItemType.whale:a=2}if(this.isAnimation)i.x=e.x-i.width/2,i.y=e.y-i.height/2,i.scaleX=i.scaleY=e.scaleX*a,e==t?(i.alpha=0,egret.Tween.get(i).to({alpha:1},500).wait(4*s).call(this.onTwCom,this)):egret.Tween.get(i,{onChange:this.onTwChg,onChangeObj:this}).wait(200).to({x:t.x-i.width/2*t.scaleX*a,y:t.y-i.height/2*t.scaleX*a,scaleX:t.scaleX*a,scaleY:t.scaleX*a},s).call(this.onTwCom,this),this.type==ItemType.coin&&DEBUGME(DS.able_eat_coin)&&Notify.One().add(NotifyName.car_moving,this.onNtf,this);
else{s=4e3,a=.5;var n=egret.Ease.quartIn;switch(this.type){case ItemType.water1:a=1;break;case ItemType.well1:a=.9;break;case ItemType.hole1:a=.9;break;case ItemType.chest_red_clearly:case ItemType.chest_yellow_speedon_invincible:case ItemType.chest_orange_easyGetChest:case ItemType.chest_blue_all_effect:case ItemType.chest_green_addHp:case ItemType.chest_purple_secret:case ItemType.chest_girl:case ItemType.chest_tree:a=1;break;case ItemType.glassRoad:a=2,s=2e3;break;case ItemType.cloud:s=2e4,n=egret.Ease.sineIn,a=2;break;default:a=1}switch(this.type){case ItemType.pop_blue:case ItemType.pop_green:case ItemType.pop_yellow:case ItemType.pop_orange:case ItemType.pop_red:case ItemType.pop_purple:case ItemType.pop_tree:case ItemType.pop_girl:return i.x=e.x,i.y=e.y,i.scaleX=i.scaleY=.01,i.alpha=1,egret.Tween.get(i).wait(2400).to({alpha:0},200),void egret.Tween.get(i).to({x:t.x,y:t.y,scaleX:t.scaleX,scaleY:t.scaleX},400,egret.Ease.backOut).wait(2e3).to({x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleX},400,egret.Ease.backIn).call(this.onTwCom,this)}switch(i.scaleX=i.scaleY=e.scaleX*a*.1,i.x=e.x-i.width/2*i.scaleX,i.y=e.y-i.height/2*i.scaleX,i.alpha=0,egret.Tween.get(i).to({alpha:1},500),egret.Tween.get(i).to({scaleX:t.scaleX*a,scaleY:t.scaleX*a},s,n),egret.Tween.get(i,{onChange:this.onTwChg,onChangeObj:this}).to({x:t.x-i.width/2*t.scaleX*a,y:t.y-i.height/2*t.scaleX*a},s,n).call(this.onTwCom,this),this.type){case ItemType.glassRoad:break;default:Notify.One().add(NotifyName.car_moving,this.onNtf,this)}}},t.prototype.onTwChg=function(e){if(!this.isDetected){var t=this.isAnimation?this.anm:this.img;if(this.isAnimation){if(this.detectTarget){var o=this.detectTarget.localToGlobal(0,0),i=new egret.Rectangle(o.x,o.y,this.detectTarget.width,this.detectTarget.height),s=t.localToGlobal(0,0);i.containsPoint(s)&&(Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0,this.killMe())}}else if(this.detectTarget){var o=this.detectTarget.localToGlobal(0,0),i=new egret.Rectangle(o.x,o.y,this.detectTarget.width,this.detectTarget.height),s=t.localToGlobal(0,0),a=20,n=new egret.Rectangle(s.x+a,s.y+a,t.width*t.scaleX-2*a,t.height*t.scaleX-2*a);if(DEBUGME(DS.debug_draw_area)&&(this.graphics.clear(),this.graphics.beginFill(16711680,.8),this.graphics.drawRect(n.x,n.y,n.width,n.height),this.graphics.endFill()),Conf.One.hitRect(i,n))switch(this.type){case ItemType.hole1:case ItemType.water1:case ItemType.well1:Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0;break;default:Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0,this.killMe()}}}},t.prototype.stopMe=function(){var e=this.isAnimation?this.anm:this.img;egret.Tween.removeTweens(e)},t.prototype.killMe=function(){var e=this.isAnimation?this.anm:this.img;this.mask&&(this.mask.parent.removeChild(this.mask),this.mask=null),this.parent&&(Notify.One().removeTarget(this),egret.Tween.removeTweens(e),this.detectTarget=null,this.parent.removeChild(this))},t.prototype.onTwCom=function(e){this.killMe()},t.prototype.onNtf=function(e){switch(e.name){case NotifyName.car_moving:this.detectTarget=e.userdata.target}},t}(egret.Sprite);__reflect(Item.prototype,"Item");