function DEBUGME(e){return(debugSwitcher&e)>0}var __reflect=this&&this.__reflect||function(e,t,s){e.__class__=t,s?s.push(t):s=[t],e.__types__=e.__types__?s.concat(e.__types__):s},__extends=this&&this.__extends||function(e,t){function s(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);s.prototype=t.prototype,e.prototype=new s},__awaiter=this&&this.__awaiter||function(e,t,s,a){return new(s||(s=Promise))(function(o,i){function n(e){try{_(a.next(e))}catch(t){i(t)}}function r(e){try{_(a["throw"](e))}catch(t){i(t)}}function _(e){e.done?o(e.value):new s(function(t){t(e.value)}).then(n,r)}_((a=a.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function s(e){return function(t){return a([e,t])}}function a(s){if(o)throw new TypeError("Generator is already executing.");for(;_;)try{if(o=1,i&&(n=i[2&s[0]?"return":s[0]?"throw":"next"])&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[0,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return _.label++,{value:s[1],done:!1};case 5:_.label++,i=s[1],s=[0];continue;case 7:s=_.ops.pop(),_.trys.pop();continue;default:if(n=_.trys,!(n=n.length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){_=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){_.label=s[1];break}if(6===s[0]&&_.label<n[1]){_.label=n[1],n=s;break}if(n&&_.label<n[2]){_.label=n[2],_.ops.push(s);break}n[2]&&_.ops.pop(),_.trys.pop();continue}s=t.call(e,_)}catch(a){s=[6,a],i=0}finally{o=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}var o,i,n,r,_={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),"throw":s(1),"return":s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},ui_road_def=function(e){function t(){var t=e.call(this)||this;return t._status=CarStatus.NONE,t._status_sub=CarStatus.NONE,t.is_debug_board_showed=!0,t.is_car_turning=!1,t.coin_pots=[],t.cloudy_tw=null,t.speedup_road_cur=0,t.glass_cur=0,t.count_clearly=100,t}return __extends(t,e),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},set:function(e){this._status=e,Conf.One.car_status=this._status},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status_sub",{get:function(){return this._status_sub},set:function(e){this._status_sub=e,Conf.One.car_status_sub=this._status_sub},enumerable:!0,configurable:!0}),t.prototype.reset=function(){var e=this;DEBUGME(DS.cloudy_motion1)||(this.ly_cloudy.visible=!1),DEBUGME(DS.debug_draw_area)&&(this.mcDetectTarget.alpha=.5,this.mcAbsorbTarget.alpha=.5),DEBUGME(DS.car_clearly_first)&&this.car_clearly(!0),DEBUGME(DS.debug_button_group)?(this.bt_d_close.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),e.debug_board_display(),Conf.One.is_game_end&&e.start_play()},this),this.bt_d_coin.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_more_coins(3)},this),this.bt_d_ship.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_shipWar()},this),this.bt_d_whale.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_whale()},this),this.bt_d_hole.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_trap(ItemType.hole1)},this),this.bt_d_well.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_trap(ItemType.well1)},this),this.bt_d_water.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_trap(ItemType.water1)},this),this.bt_d_popboard.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_popInfo(ItemType.pop_red)},this),this.bt_d_glassroad.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_glassRoad()},this),this.bt_d_infokm.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_info_km(-1e3)},this),this.bt_d_gameover.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),Notify.One().post(NotifyName.game_end)},this),this.bt_d_fog.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_fog()},this),this.bt_d_chest1red.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button,!1),e.create_chest(ItemType.chest_red_clearly)},this),this.bt_d_chest2green.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_green_addHp)},this),this.bt_d_chest3orange.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_orange_easyGetChest)},this),this.bt_d_chest4yellow.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_yellow_speedon_invincible)},this),this.bt_d_chest5blue.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_blue_all_effect)},this),this.bt_d_chest6purple.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_purple_secret)},this),this.bt_d_chest7tree.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_tree)},this),this.bt_d_chest8girl.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_girl)},this),this.bt_d_game.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){JS_start_game({},Network.One.start_game_callback,Network.One)},this),this.bt_d_share.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){JS_share_revive({},Network.One.share_revive_callback,Network.One)},this),this.bt_d_score.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Network.One.send_score()},this)):this.ly_debug_btns.visible=!1},t.prototype.start_play=function(){},t.prototype.absorb_chest=function(e){var t=this;null==this.mcAbsorb&&(this.mcAbsorb=new egret.Sprite,this.addChild(this.mcAbsorb)),egret.Tween.removeTweens(this.mcAbsorb),this.status_sub=this.status_sub|CarStatus.absorb,egret.Tween.get(this.mcAbsorb).wait(1e3*e*egret.Tween.TIMESCALE).call(function(){t.status_sub=t.status_sub&~CarStatus.absorb},this)},t.prototype.create_fog=function(){this.motion_chest(ItemType.fog,ItemPosition.fog)},t.prototype.create_cloudy_motion=function(){if(DEBUGME(DS.cloudy_motion2)){null==this.cloudy_tw&&(this.cloudy_tg=new egret.tween.TweenGroup,this.cloudy_tw=new egret.Sprite,this.ly_pots.addChild(this.cloudy_tw));for(var e=0;50>e;e++)this.motion_chest(ItemType.cloud,ItemPosition.cloudPos_around,1,Math.random());egret.Tween.get(this.cloudy_tw,{loop:!0}).wait(600).call(this.create_cloudy_motion_real,this)}else DEBUGME(DS.cloudy_motion1)&&(this.mov_cloudy.play(2e5*Math.random()),this.mov_cloudy.addEventListener("complete",this.onTweenGroupComplete,this))},t.prototype.create_cloudy_motion_real=function(){Math.random()<.2||this.motion_chest(ItemType.cloud,ItemPosition.cloudPos_around)},t.prototype.stop_cloudy=function(){egret.Tween.removeTweens(this.cloudy_tw);for(var e=this.cloudy_tw.numChildren-1;e>=0;e--)this.cloudy_tw.getChildAt(e).stopMe()},t.prototype.create_info_km=function(e){0>e&&Notify.One().post(NotifyName.car_speed_slowdown),this.ly_pop_km.visible=!0,this.ly_pop_km.alpha=1,egret.Tween.removeTweens(this.ly_pop_km),this.txt_pop_km.text=e.toString(),0>e?Conf.One.set_color(this.ly_pop_km,13113111):Conf.One.set_color(this.ly_pop_km,65328),this.ly_pop_km.bottom=Conf.One.info_km_pos.y;var t=100;egret.Tween.removeTweens(this.ly_pop_km);var s=egret.Tween.get(this.ly_pop_km).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(500).call(function(){Notify.One().post(NotifyName.car_hp_change,{value:e})}).to({bottom:Conf.One.info_km_pos.y+20,alpha:0},1e3);s.timeScale=1/egret.Tween.TIMESCALE},t.prototype.speedUp=function(e){var t=this;this.status!=CarStatus.gameover&&this.status!=CarStatus.invincible&&(this.ly_road_speedup.visible=!0,this.status=CarStatus.invincible,egret.Tween.TIMESCALE=Conf.One.tween_timescale.speedup,egret.Tween.removeTweens(this.ly_road_speedup),egret.Tween.get(this.ly_road_speedup,{loop:!0}).wait(100).call(this.speedup_roadchange,this),egret.Tween.get(this.ly_road_speedup).wait(1e3*e*egret.Tween.TIMESCALE).call(function(){t.status==CarStatus.invincible&&(egret.Tween.TIMESCALE=Conf.One.tween_timescale["default"],t.status=CarStatus.NONE,egret.Tween.removeTweens(t.ly_road_speedup),t.ly_road_speedup.visible=!1)},this))},t.prototype.speedup_roadchange=function(){this.speedup_road_cur++%2==0?(this.road_speed1.visible=!1,this.road_speed2.visible=!0):(this.road_speed2.visible=!1,this.road_speed1.visible=!0)},t.prototype.create_whale=function(){this.motion_chest(ItemType.whale,ItemPosition.whalePot)},t.prototype.create_shipWar=function(){var e=this;this.mcShipwar||(this.mcShipwar=new egret.Sprite,this.addChild(this.mcShipwar)),this.motion_chest(ItemType.globalPlanet,ItemPosition.globalPlanet),egret.Tween.removeTweens(this.mcShipwar),egret.Tween.get(this.mcShipwar).wait(500).call(function(){e.motion_chest(ItemType.plane2,ItemPosition.ship_rightToLeft)}).wait(200).call(function(){e.motion_chest(ItemType.plane1,ItemPosition.ship_leftToRight)}).wait(3e3).call(function(){egret.Tween.removeTweens(e.mcShipwar)},this)},t.prototype.create_visionBlock=function(){this.ly_blocks.visible=!0,this.ly_blocks.alpha=0,egret.Tween.get(this.ly_blocks).to({alpha:1},400).wait(2e3).to({alpha:0},900).set({visible:!1})},t.prototype.create_trap=function(e){if(!(this.status_sub&CarStatus.glassroad||this.status&CarStatus.gameover)){switch(e){case ItemType.well1:Math.random()>.85?(this.motion_chest(e,ItemPosition.left),this.motion_chest(e,ItemPosition.right)):this.motion_chest(e,ItemPosition.pot3_random);break;default:this.motion_chest(e,ItemPosition.pot2middle_random)}Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget,absorb:this.mcAbsorbTarget})}},t.prototype.create_chest=function(e){this.motion_chest(e,ItemPosition.pot3_random),Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget,absorb:this.mcAbsorbTarget})},t.prototype.create_popInfo=function(e){for(var t=this.ly_popboard.numChildren-1;t>=0;t--){var s=this.ly_popboard.getChildAt(t);s&&s.fadeOutMe()}switch(e){case ItemType.chest_red_clearly:this.motion_chest(ItemType.pop_red,ItemPosition.popScale);break;case ItemType.chest_blue_all_effect:this.motion_chest(ItemType.pop_blue,ItemPosition.popScale);break;case ItemType.chest_green_addHp:this.motion_chest(ItemType.pop_green,ItemPosition.popScale);break;case ItemType.chest_yellow_speedon_invincible:this.motion_chest(ItemType.pop_yellow,ItemPosition.popScale);break;case ItemType.chest_orange_easyGetChest:this.motion_chest(ItemType.pop_orange,ItemPosition.popScale);break;case ItemType.chest_purple_secret:this.motion_chest(ItemType.pop_purple,ItemPosition.popScale);break;case ItemType.chest_girl:this.motion_chest(ItemType.pop_girl,ItemPosition.popScale);break;case ItemType.chest_tree:this.motion_chest(ItemType.pop_tree,ItemPosition.popScale);break;default:this.motion_chest(e,ItemPosition.popScale)}},t.prototype.create_glassRoad=function(e){var t=this;void 0===e&&(e=15),this.status_sub=this.status_sub|CarStatus.glassroad,this.glass_cur=e,null==this.glass_tw_obj&&(this.glass_tw_obj=new egret.Sprite,this.addChild(this.glass_tw_obj)),egret.Tween.removeTweens(this.glass_tw_obj),egret.Tween.get(this.glass_tw_obj).wait(1e3*egret.Tween.TIMESCALE).call(function(){egret.Tween.get(t.glass_tw_obj,{loop:!0}).wait(280).call(t.create_glass_road_real,t)},this)},t.prototype.create_glass_road_real=function(){var e=this;this.glass_cur>0?(this.glass_cur--,this.motion_chest(ItemType.glassRoad,ItemPosition.glassRoad)):(egret.Tween.removeTweens(this.glass_tw_obj),egret.Tween.get(this.glass_tw_obj).wait(1e3*egret.Tween.TIMESCALE).call(function(){e.status_sub=e.status_sub&~CarStatus.glassroad},this))},t.prototype.create_more_coins=function(e){var t=this;null==this.mcCoin&&(this.mcCoin=new egret.Sprite,this.addChild(this.mcCoin)),egret.Tween.get(this.mcCoin).wait(1e3*e).call(function(){egret.Tween.removeTweens(t.mcCoin)},this),egret.Tween.get(this.mcCoin,{loop:!0}).wait(280).call(this.create_more_coins_real,this)},t.prototype.create_more_coins_real=function(){this.coin_pots=Conf.One.coin_next_group();for(var e=0;e<this.coin_pots.length;e++)this.motion_chest(ItemType.coin,ItemPosition.top_down_randomV,1,this.coin_pots[e]);Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget,absorb:this.mcAbsorbTarget})},t.prototype.car_toClearly=function(){var e=this,t=50;egret.Tween.removeTweens(this.car),egret.Tween.get(this.car).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).call(function(){e.car_clearly(!0)},this).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t)},t.prototype.car_clearly=function(e){e?this.car.source="res01_json.car":this.car.source="res01_json.car_masaka"},t.prototype.onTweenGroupComplete=function(e){switch(e.target){case this.mov_road_def:e.target.play(0);break;case this.mov_cloudy:e.target.play(0);break;default:this.is_car_turning=!1}},t.prototype.debug_board_display=function(){this.is_debug_board_showed=!this.is_debug_board_showed;for(var e=this.ly_debug_btns.numChildren-1;e>=0;e--){var t=this.ly_debug_btns.getChildAt(e);t!=this.bt_d_close&&(t.visible=this.is_debug_board_showed)}},t.prototype.motion_chest=function(e,t,s,a){void 0===s&&(s=1);var o={x:0,y:0,scaleX:1},i={x:0,y:0,scaleX:1},n=1;if(t==ItemPosition.pot3_random){var r=[ItemPosition.left,ItemPosition.middle,ItemPosition.right];t=r[Math.floor(Math.random()*r.length)]}else if(t==ItemPosition.pot2middle_random){var _=[ItemPosition.lm_center,ItemPosition.mr_center];t=_[Math.floor(Math.random()*_.length)]}else if(t==ItemPosition.cloud_random){var c=[ItemPosition.cloudPos_left,ItemPosition.cloudPos_right];t=c[Math.floor(Math.random()*c.length)]}switch(t){case ItemPosition.left:o.x=this.p_start1.x,o.y=this.stage.stageHeight-this.p_start1.bottom,o.scaleX=this.p_start1.scaleX;break;case ItemPosition.lm_center:o.x=(this.p_start1.x+this.p_start2.x)/2,o.y=this.stage.stageHeight-this.p_start1.bottom,o.scaleX=this.p_start1.scaleX;break;case ItemPosition.middle:o.x=this.p_start2.x,o.y=this.stage.stageHeight-this.p_start2.bottom,o.scaleX=this.p_start2.scaleX;break;case ItemPosition.mr_center:o.x=(this.p_start2.x+this.p_start3.x)/2,o.y=this.stage.stageHeight-this.p_start3.bottom,o.scaleX=this.p_start3.scaleX;break;case ItemPosition.right:o.x=this.p_start3.x,o.y=this.stage.stageHeight-this.p_start3.bottom,o.scaleX=this.p_start3.scaleX;break;case ItemPosition.top_down_randomV:o.x=a,o.y=0,o.scaleX=1;break;case ItemPosition.ship_leftToRight:o.x=this.p_start4.x,o.y=this.p_start4.top,o.scaleX=this.p_start4.scaleX;break;case ItemPosition.ship_rightToLeft:o.x=this.p_start5.x,o.y=this.p_start5.top,o.scaleX=this.p_start5.scaleX;break;case ItemPosition.whalePot:o.x=this.p_start6.x,o.y=this.stage.stageHeight-this.p_start6.bottom,o.scaleX=this.p_start6.scaleX;break;case ItemPosition.globalPlanet:o.x=this.p_start2.x,o.y=this.stage.stageHeight-this.p_start2.bottom,o.scaleX=this.p_start2.scaleX;break;case ItemPosition.popScale:o.x=this.stage.stageWidth/2,o.y=this.ly_popboard.height/2,o.scaleX=0;break;case ItemPosition.glassRoad:o.x=this.p_start2.x,o.y=this.stage.stageHeight-this.p_start2.bottom,o.scaleX=1.2;break;case ItemPosition.cloudPos_left:o.x=this.p_start1.x,o.y=this.stage.stageHeight-this.p_start1.bottom-50,o.scaleX=0;break;case ItemPosition.cloudPos_right:o.x=this.p_start3.x,o.y=this.stage.stageHeight-this.p_start3.bottom-50,o.scaleX=0;break;case ItemPosition.cloudPos_around:o.x=this.p_start2.x,o.y=this.stage.stageHeight-this.p_start3.bottom-50,o.scaleX=0;break;case ItemPosition.fog:o.x=this.p_start2.x,o.y=this.stage.stageHeight-this.p_start2.bottom,o.scaleX=this.p_start2.scaleX}switch(t){case ItemPosition.left:i.x=this.p_end1.x,i.y=this.stage.stageHeight-this.p_end1.bottom,i.scaleX=this.p_end1.scaleX;break;case ItemPosition.lm_center:i.x=this.p_end2.x,i.y=this.stage.stageHeight-this.p_end2.bottom,i.scaleX=this.p_end2.scaleX;break;case ItemPosition.middle:i.x=this.p_end3.x,i.y=this.stage.stageHeight-this.p_end3.bottom,i.scaleX=this.p_end3.scaleX;break;case ItemPosition.mr_center:i.x=this.p_end4.x,i.y=this.stage.stageHeight-this.p_end4.bottom,i.scaleX=this.p_end4.scaleX;break;case ItemPosition.right:i.x=this.p_end5.x,i.y=this.stage.stageHeight-this.p_end5.bottom,i.scaleX=this.p_end5.scaleX;break;case ItemPosition.top_down_randomV:i.x=o.x,i.y=this.ly_pots.height,i.scaleX=1;break;case ItemPosition.ship_leftToRight:i=o;break;case ItemPosition.ship_rightToLeft:i=o;break;case ItemPosition.whalePot:i=o;break;case ItemPosition.popScale:i.scaleX=2;break;case ItemPosition.glassRoad:i.x=this.p_end3.x,i.y=1.5*this.stage.stageHeight-this.p_end3.bottom,i.scaleX=this.p_end5.scaleX;break;case ItemPosition.cloudPos_left:i.x=o.x-4*this.stage.stageWidth,i.y=o.y+(Math.random()-.5)*this.stage.stageHeight*5,i.scaleX=this.p_end1.scaleX;break;case ItemPosition.cloudPos_right:i.x=o.x+4*this.stage.stageWidth,i.y=o.y+(Math.random()-.5)*this.stage.stageHeight*5,i.scaleX=this.p_end1.scaleX;break;case ItemPosition.cloudPos_around:var h=2*this.stage.stageHeight,l=Math.PI/180*(Math.random()-.5)*230;i.x=o.x+Math.sin(l)*h,i.y=o.y-Math.cos(l)*h,i.scaleX=this.p_end1.scaleX,null!=a&&a>0&&1>=a&&(o.x+=(i.x-o.x)*a,o.y+=(i.y-o.y)*a,o.scaleX+=(i.scaleX-o.scaleX)*a*10,n=1-a);break;case ItemPosition.fog:i.x=this.p_end3.x+300*(Math.random()-.5),i.y=o.y+.7*(this.p_end3.y-o.y),i.scaleX=2*this.p_end3.scaleX;break;case ItemPosition.globalPlanet:default:i=o}var p=(new Item).reset(e);switch(t==ItemPosition.popScale&&(i.x=(this.stage.stageWidth-p.width*i.scaleX)/2,i.y=(this.ly_popboard.height-p.height*i.scaleX)/2),e){case ItemType.glassRoad:this.ly_pots_glassroad.addChild(p);var d=new eui.Image("res01_json.road_bg");this.addChild(d),d.alpha=1,d.horizontalCenter=this.road_masker.horizontalCenter,d.bottom=this.road_masker.bottom,d.width=this.road_masker.width,d.height=this.road_masker.height,p.mask=d;break;case ItemType.globalPlanet:case ItemType.whale:this.ly_pots_planet.addChild(p);break;case ItemType.well1:case ItemType.water1:case ItemType.hole1:this.ly_pots_trap.addChild(p);break;case ItemType.pop_blue:case ItemType.pop_green:case ItemType.pop_yellow:case ItemType.pop_orange:case ItemType.pop_red:case ItemType.pop_purple:case ItemType.pop_tree:case ItemType.pop_girl:this.ly_popboard.addChild(p);break;case ItemType.cloud:DEBUGME(DS.cloudy_motion2)&&this.cloudy_tw.addChildAt(p,0);break;case ItemType.fog:this.ly_pots.addChild(p),s=6;break;default:this.ly_pots.addChildAt(p,0)}t!=ItemPosition.NONE&&p.motion(o,i,s,n)},t}(eui.Component);__reflect(ui_road_def.prototype,"ui_road_def",["eui.UIComponent","egret.DisplayObject"]);var Notify=function(){function e(){this.dicNtfs={},console.log("Notify::Init")}return e.One=function(){return null==this.__single&&(this.__single=new e),this.__single},e.prototype.post=function(e,t){if(void 0===t&&(t=null),null!=this.dicNtfs[e])for(var s=this.dicNtfs[e],a=0;a<s.length;a++)s[a].post(t)},e.prototype.add=function(e,t,s){if(null!=s&&null!=t){null==this.dicNtfs[e]&&(this.dicNtfs[e]=[]);for(var a in this.dicNtfs[e])if(this.dicNtfs[e].hasOwnProperty(a)&&this.dicNtfs[e][a].target==s)return void console.warn("Notify::Add::Repeat::"+e);var o=new NotifyObserve(e,s,t);this.dicNtfs[e].push(o)}},e.prototype.clear=function(){for(var e in this.dicNtfs)for(var t=this.dicNtfs[e],s=t.length-1;s>=0;s--)t[s].clear();this.dicNtfs={}},e.prototype.removeName=function(e){for(var t in this.dicNtfs)if(e==t){for(var s=this.dicNtfs[t],a=s.length-1;a>=0;a--)s[a].clear();this.dicNtfs[t]=null,delete this.dicNtfs[t]}},e.prototype.removeTarget=function(e){for(var t in this.dicNtfs)for(var s=this.dicNtfs[t],a=s.length-1;a>=0;a--)s[a].target==e&&(s[a].clear(),s.splice(a,1))},e}();__reflect(Notify.prototype,"Notify");var NotifyObserve=function(){function e(e,t,s){this.target=t,this.name=e,this.func=s}return e.prototype.post=function(e){this.userdata=e,this.func.call(this.target,this)},e.prototype.clear=function(){this.target=null,this.name=null,this.func=null,this.userdata=null},e}();__reflect(NotifyObserve.prototype,"NotifyObserve");var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return s.sent(),[4,this.loadTheme()];case 2:return s.sent(),[4,RES.loadGroup("preload",0,e)];case 3:return s.sent(),this.stage.removeChild(e),[3,5];case 4:return t=s.sent(),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,s){var a=new eui.Theme("resource/default.thm.json",e.stage);a.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){Conf.One.reset(this.stage),egret.Ticker.getInstance().register(function(e){dragonBones.WorldClock.clock.advanceTime(e/1e3)},this);var e=new ui_road;this.addChild(e)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,s,a){function o(e){t.call(a,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),s.call(a))}var n=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(a,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,s){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(a,generateEUI2)},n)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var r=e.split("/");r.pop();var _=r.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(a,generateJSON.paths[e])},this):RES.getResByUrl(_,function(s){window.JSONParseClass.setData(s),egret.callLater(function(){t.call(a,generateJSON.paths[e])},n)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(a,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Conf=function(){function e(){this.is_game_end=!1,this.info_km_pos={x:0,y:0},this.info_is_addedlife=!1,this.Coin_Collect_Total=0,this.Revive_Times=0,this.range_car_move=new egret.Rectangle(100,0,0,0),this.coin_rand_pot=0,this.coin_pot_cur=0,this.coin_pots_odd=[],this.coin_pots_even=[],this.item_distance=18,this.animation_random_seed=0,this.framerate=30,this.km_max=490,this.game_time_spend=10,this.tween_timescale={"default":1.5,speedup:2.5,trap:.3,slow:.5},this.gameinfo={score:0,scoreAndFrame:0,total:0,checkpoint:0,checkpoint_mov:0,checkpoint_fog:0,green:0,blue:0,girl:0,tree:0,secret:0,red:0,orange:0,yellow:0,trap_water:0,trap_hole:0,trap_well:0},this.dic_item_typename={},this.dic_sfxs={},this.stage_level=[],this.stage_level_cur=0,this.stage_level_firstOne=!0,this.coin_cur_odd=!0,this.cloud_ran_cur=0,Network.One,window.document.conf=this,console.log(["Game_name2type",this.Game_name2type("品质宝箱")]),console.log(["Game_type2name",this.Game_type2name(ItemType.chest_blue_all_effect)])}return e.prototype.reset=function(e){this.STAGE=e,egret.Tween.TIMESCALE=this.tween_timescale["default"],this.animation_random_seed=Math.floor(3*Math.random());for(var t in this.gameinfo)this.gameinfo[t]=0;this.dic_item_typename[ItemType.chest_red_clearly]="颜值宝箱",this.dic_item_typename[ItemType.chest_green_addHp]="续航宝箱",this.dic_item_typename[ItemType.chest_orange_easyGetChest]="安全宝箱",this.dic_item_typename[ItemType.chest_yellow_speedon_invincible]="动力宝箱",this.dic_item_typename[ItemType.chest_orange_easyGetChest]="安全宝箱",this.dic_item_typename[ItemType.chest_blue_all_effect]="品质宝箱",this.dic_item_typename[ItemType.chest_purple_secret]="神秘宝箱",this.dic_item_typename[ItemType.chest_girl]="女神宝箱",this.dic_item_typename[ItemType.chest_tree]="公益宝箱",this.dic_item_typename[ItemType.well1]="井盖",this.dic_item_typename[ItemType.hole1]="深坑",this.dic_item_typename[ItemType.water1]="水坑",this.gameinfo.total=this.km_max*this.framerate,this.is_game_end=!1,this.Coin_Collect_Total=0,this.Revive_Times=1,this.range_car_move.width=this.STAGE.stageWidth-this.range_car_move.x,this.info_is_addedlife=!1,this.coin_pots_odd=[],this.coin_pots_even=[];for(var s=6,a=50,o=(this.STAGE.stageWidth-2*a)/(s-1),i=0;s>i;i++)i%2==1?this.coin_pots_odd.push(i*o+a):this.coin_pots_even.push(i*o+a)},e.prototype.Game_name2type=function(e){for(var t in this.dic_item_typename)if(this.dic_item_typename[t]==e)return parseInt(t);return ItemType.NONE},e.prototype.Game_type2name=function(e){return this.dic_item_typename[e]},e.prototype.Game_nameCount=function(e){var t=this.Game_name2type(e);switch(t){case ItemType.chest_red_clearly:return this.gameinfo.red;case ItemType.chest_yellow_speedon_invincible:return this.gameinfo.yellow;case ItemType.chest_orange_easyGetChest:return this.gameinfo.orange;case ItemType.chest_green_addHp:return this.gameinfo.green;case ItemType.chest_blue_all_effect:return this.gameinfo.blue;case ItemType.chest_purple_secret:return this.gameinfo.secret;case ItemType.chest_tree:return this.gameinfo.tree;case ItemType.chest_girl:return this.gameinfo.girl;case ItemType.water1:return this.gameinfo.trap_water;case ItemType.well1:return this.gameinfo.trap_well;case ItemType.hole1:return this.gameinfo.trap_hole}},e.prototype.play_snd=function(e,t){void 0===t&&(t=!1);var s;switch(e){case ItemType.chest_red_clearly:s="sfx_good_mp3";break;case ItemType.chest_green_addHp:s="sfx_good_mp3";break;case ItemType.chest_blue_all_effect:s="sfx_good2_mp3";break;case ItemType.chest_orange_easyGetChest:s="sfx_good_mp3";break;case ItemType.chest_yellow_speedon_invincible:s="sfx_good_mp3";break;case ItemType.chest_girl:s="sfx_good4_mp3";break;case ItemType.chest_tree:s="sfx_good4_mp3";break;case ItemType.chest_purple_secret:s="sfx_good3_mp3";break;case ItemType.hole1:s="sfx_car_break_01_mp3";break;case ItemType.well1:s="sfx_car_break_01_mp3";break;case ItemType.water1:s="sfx_water_splash_mp3";break;case ItemType.sfx_car_moving:s="sfx_car_move_loop_mp3";break;case ItemType.sfx_gameover:s="sfx_success1_mp3";break;case ItemType.button:s="sfx_bubble_mp3";break;case ItemType.bgm:s="bgm_mp3";break;case ItemType.sfx_absorb:s="sfx_absorb_mp3"}if(s){var a=RES.getRes(s);a?t?this.dic_sfxs[e]=a.play(0,-1):a.play(0,1):console.warn(s+" NULL !!!")}},e.prototype.stop_snd=function(e){this.dic_sfxs[e]&&(this.dic_sfxs[e].stop(),delete this.dic_sfxs[e])},e.prototype.stopAll_snd=function(){for(var e in this.dic_sfxs)this.dic_sfxs[e]&&this.dic_sfxs[e].stop();this.dic_sfxs={}},Object.defineProperty(e.prototype,"info_ph",{get:function(){return Math.round(this.gameinfo.total/this.framerate)},set:function(e){this.gameinfo.total+=e*this.framerate},enumerable:!0,configurable:!0}),e.prototype.next_stage_level_unit=function(){if(this.stage_level_firstOne)return this.stage_level_firstOne=!1,this.stage_level_cur=0,this.stage_level.shift();if(this.stage_level_cur+=Math.floor(4*Math.random())+1,this.stage_level_cur>=this.stage_level.length&&(this.stage_level_cur=this.stage_level.length-this.stage_level_cur),this.gameinfo.score>200){var e=[ItemType.hole1,ItemType.water1,ItemType.well1];return Math.random()>.3?this.stage_level[this.stage_level_cur%this.stage_level.length]:e[Math.floor(Math.random()*e.length)]}return this.stage_level[this.stage_level_cur%this.stage_level.length]},e.prototype.create_stage_level=function(){this.stage_level_cur=0,this.stage_level_firstOne=!0,this.stage_level.push(ItemType.chest_red_clearly);var e=[],t={};t[ItemType.NONE]=50,t[ItemType.chest_green_addHp]=10,t[ItemType.chest_orange_easyGetChest]=20,t[ItemType.chest_yellow_speedon_invincible]=20,t[ItemType.chest_blue_all_effect]=15,this.chest_secret_max&&(t[ItemType.chest_purple_secret]=15),this.chest_girl_max&&(t[ItemType.chest_girl]=15),this.chest_tree_max&&(t[ItemType.chest_tree]=15),t[ItemType.hole1]=300,t[ItemType.water1]=300,t[ItemType.well1]=300,DEBUGME(DS.debug_item_show)&&(t={},t[ItemType.chest_orange_easyGetChest]=40,t[ItemType.well1]=100);var s=0;for(var a in t)e.push({type:parseInt(a),value:t[a],start:s,end:s+t[a]}),s+=t[a];for(var o=0;1e3>o;o++)for(var i=Math.random()*s,n=Math.min(Math.round(.5*e.length),e.length-1),r=0;r<e.length;r++)if(i<e[n].start)n--;else{if(!(i>e[n].end)){this.stage_level.push(e[n].type);break}n++}console.log(this.stage_level)},e.prototype.next_rand_anm_seed=function(){var e=3;return this.animation_random_seed=(this.animation_random_seed+Math.floor(Math.random()*(e-1))+1)%e,this.animation_random_seed},e.prototype.get_able_revive=function(){return this.Revive_Times<=0},e.prototype.set_chest_got=function(e){switch(e){case ItemType.chest_purple_secret:this.chest_secret_max=Math.max(0,this.chest_secret_max-1),this.gameinfo.secret+=1;break;case ItemType.chest_girl:this.chest_girl_max=Math.max(0,this.chest_girl_max-1),this.gameinfo.girl+=1;break;case ItemType.chest_tree:this.chest_tree_max=Math.max(0,this.chest_tree_max-1),this.gameinfo.tree+=1}},e.prototype.score_reduce=function(e){return this.gameinfo.total-=e*this.framerate,this.gameinfo.total<=0&&(this.gameinfo.total=0,this.is_game_end=!0,Notify.One().post(NotifyName.game_end)),this.info_ph},e.prototype.score_addition=function(){return this.gameinfo.total-this.game_time_spend<0?(this.gameinfo.total=0,void Notify.One().post(NotifyName.game_end)):(this.gameinfo.total-=this.game_time_spend,this.gameinfo.scoreAndFrame+=this.game_time_spend,void(this.gameinfo.score=Math.round(this.gameinfo.scoreAndFrame/this.framerate)))},e.prototype.coin_rand=function(){for(var e=this.coin_pot_cur,t=0;5>t;t++)e==this.coin_pot_cur&&(this.coin_pot_cur=Math.floor(Math.random()*this.coin_pots_odd.length));return this.coin_rand_pot=this.coin_pots_odd[this.coin_pot_cur],this.coin_rand_pot},e.prototype.coin_next_group=function(){return this.coin_cur_odd=!this.coin_cur_odd,this.coin_cur_odd?this.coin_pots_odd:this.coin_pots_even},e.prototype.anm_load=function(e,t){void 0===t&&(t=0);var s=RES.getRes("anm1_ske_json"),a=RES.getRes("anm1_tex_png"),o=RES.getRes("anm1_tex_json"),i=new dragonBones.EgretFactory;
i.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(s)),i.addTextureAtlas(new dragonBones.EgretTextureAtlas(a,o));var n;switch(e){case AnimationName.coin:n=i.buildArmatureDisplay("anm1"),n.animation.gotoAndPlayByTime("coin",t);break;case AnimationName.globalPlanet:n=i.buildArmatureDisplay("anm1"),n.animation.play("planet",1);break;case AnimationName.plane1:n=i.buildArmatureDisplay("plane1_fly"),n.animation.play("newAnimation",1);break;case AnimationName.plane2:n=i.buildArmatureDisplay("plane2_fly"),n.animation.play("newAnimation",1);break;case AnimationName.whale:n=i.buildArmatureDisplay("anm1"),n.animation.play("whale",1)}return n},e.prototype.res_load=function(e){var t=null;switch(e){case ItemType.chest_red_clearly:t=RES.getRes("res01_json.chest_red");break;case ItemType.chest_green_addHp:t=RES.getRes("res01_json.chest_green");break;case ItemType.chest_yellow_speedon_invincible:t=RES.getRes("res01_json.chest_yellow");break;case ItemType.chest_orange_easyGetChest:t=RES.getRes("res01_json.chest_orange");break;case ItemType.chest_blue_all_effect:t=RES.getRes("res01_json.chest_blue");break;case ItemType.chest_purple_secret:t=RES.getRes("res01_json.chest_purple");break;case ItemType.chest_tree:t=RES.getRes("res01_json.chest_tree");break;case ItemType.chest_girl:t=RES.getRes("res01_json.chest_girl");break;case ItemType.hole1:t=RES.getRes("res01_json.hole_1");break;case ItemType.well1:t=RES.getRes("res01_json.well_1");break;case ItemType.water1:t=RES.getRes("res01_json.water_1");break;case ItemType.pop_blue:t=RES.getRes("res01_json.pop_blue");break;case ItemType.pop_red:t=RES.getRes("res01_json.pop_red");break;case ItemType.pop_green:t=RES.getRes("res01_json.pop_green");break;case ItemType.pop_yellow:t=RES.getRes("res01_json.pop_yellow");break;case ItemType.pop_orange:t=RES.getRes("res01_json.pop_orange");break;case ItemType.pop_purple:t=RES.getRes("res01_json.pop_purple");break;case ItemType.pop_tree:t=RES.getRes("res01_json.pop_tree");break;case ItemType.pop_girl:t=RES.getRes("res01_json.pop_girl");break;case ItemType.glassRoad:t=RES.getRes("res01_json.glass_1");break;case ItemType.fog:t=RES.getRes("res01_json.fog");break;case ItemType.cloud:var s=["res01_json.cloud_1","res01_json.cloud_3"];this.cloud_ran_cur+=Math.random()>.5?1:2,t=RES.getRes(s[this.cloud_ran_cur%s.length]);break;default:console.log("res "+e+" don't config")}return t},e.prototype.hitRect=function(e,t){if(e.contains(t.topLeft.x,t.topLeft.y)||e.contains(t.topLeft.x+t.width,t.topLeft.y)||e.contains(t.topLeft.x,t.topLeft.y+t.height)||e.contains(t.topLeft.x+t.width,t.topLeft.y+t.height))return!0;var s=t;return t=e,e=s,e.contains(t.topLeft.x,t.topLeft.y)||e.contains(t.topLeft.x+t.width,t.topLeft.y)||e.contains(t.topLeft.x,t.topLeft.y+t.height)||e.contains(t.topLeft.x+t.width,t.topLeft.y+t.height)?!0:!1},e.prototype.set_color=function(e,t){var s=function(e){var t={r:0,g:0,b:0};return t.b=e%256,t.g=Math.floor(e/256)%256,t.r=Math.floor(e/256/256),t},a=s(t),o=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];o[0]=a.r/255,o[6]=a.g/255,o[12]=a.b/255;var i=new egret.ColorMatrixFilter(o);e.filters=[i]},Object.defineProperty(e,"One",{get:function(){return this._s?this._s:(this._s=new e,this._s)},enumerable:!0,configurable:!0}),e}();__reflect(Conf.prototype,"Conf");var Network=function(){function e(){this._data_info={},this._data_share={},window.document.network=this}return e.prototype.start_game_callback=function(e){this.varify_data_success(e)?this._data_info=e:console.error("start game page error")},e.prototype.share_revive_callback=function(e){Notify.One().post(NotifyName.game_revivo)},e.prototype.send_score=function(){for(var t=this._data_info.Data.Box.FunctionBoxes,s=this._data_info.Data.Box.GiftBoxes,a=[],o=(ItemType.chest_red_clearly,0);o<t.length;o++)a.push({Code:t[o].Code,Count:Conf.One.Game_nameCount(t[o].Name)});for(var o=0;o<s.length;o++)a.push({Code:s[o].Code,Count:Conf.One.Game_nameCount(s[o].Name)});console.log(a),JS_send_score({TotalKM:Conf.One.gameinfo.score,UsedBoxes:a},e.One.score_callback,e.One)},e.prototype.score_callback=function(e){console.log(e)},Object.defineProperty(e.prototype,"data_info",{get:function(){return this._data_info},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data_share",{get:function(){return this._data_share},enumerable:!0,configurable:!0}),e.prototype.varify_data_success=function(e){return null!=e&&1==e.Success?!0:!1},Object.defineProperty(e,"One",{get:function(){return this._s?this._s:(this._s=new e,this._s)},enumerable:!0,configurable:!0}),e}();__reflect(Network.prototype,"Network");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var NotifyName=function(){function e(){}return e.car_moving="car_moving",e.car_eated="car_eated",e.car_speed_slowdown="car_speed_slowdown",e.car_hp_change="car_hp_change",e.board_closed="board_closed",e.game_ready="game_ready",e.game_start="game_start",e.game_end="game_end",e.game_revivo="game_revivo",e.display_index="display_index",e.display_game="display_game",e.display_rank="display_rank",e.display_bonus="display_bonus",e}();__reflect(NotifyName.prototype,"NotifyName");var DM;!function(e){e[e.debug=1]="debug",e[e.demo=2]="demo",e[e.release=4]="release"}(DM||(DM={}));var DS;!function(e){e[e.NONE=0]="NONE",e[e.car_clearly_first=1]="car_clearly_first",e[e.debug_draw_area=2]="debug_draw_area",e[e.debug_button_group=4]="debug_button_group",e[e.able_eat_coin=8]="able_eat_coin",e[e.cloudy_motion1=16]="cloudy_motion1",e[e.cloudy_motion2=32]="cloudy_motion2",e[e.car_rotation=64]="car_rotation",e[e.debug_item_show=128]="debug_item_show"}(DS||(DS={}));var debugMode=DM.release;debugMode=0|DM.debug,debugMode=0|DM.demo;var debugSwitcher=DS.NONE;switch(debugMode){case DM.debug:debugSwitcher=DS.debug_button_group|DS.cloudy_motion2|DS.car_rotation|DS.debug_item_show|DS.debug_draw_area;break;case DM.demo:debugSwitcher=DS.debug_button_group|DS.cloudy_motion2|DS.car_rotation;break;case DM.release:default:debugSwitcher=DS.NONE|DS.cloudy_motion2|DS.car_rotation}var ItemType;!function(e){e[e.NONE=0]="NONE",e[e.chest_START=1]="chest_START",e[e.chest_red_clearly=2]="chest_red_clearly",e[e.chest_green_addHp=3]="chest_green_addHp",e[e.chest_orange_easyGetChest=4]="chest_orange_easyGetChest",e[e.chest_yellow_speedon_invincible=5]="chest_yellow_speedon_invincible",e[e.chest_blue_all_effect=6]="chest_blue_all_effect",e[e.chest_purple_secret=7]="chest_purple_secret",e[e.chest_tree=8]="chest_tree",e[e.chest_girl=9]="chest_girl",e[e.chest_END=10]="chest_END",e[e.trap_START=11]="trap_START",e[e.hole1=12]="hole1",e[e.well1=13]="well1",e[e.water1=14]="water1",e[e.trap_END=15]="trap_END",e[e.coin=16]="coin",e[e.plane1=17]="plane1",e[e.plane2=18]="plane2",e[e.globalPlanet=19]="globalPlanet",e[e.whale=20]="whale",e[e.pop_blue=21]="pop_blue",e[e.pop_green=22]="pop_green",e[e.pop_yellow=23]="pop_yellow",e[e.pop_red=24]="pop_red",e[e.pop_orange=25]="pop_orange",e[e.pop_purple=26]="pop_purple",e[e.pop_tree=27]="pop_tree",e[e.pop_girl=28]="pop_girl",e[e.glassRoad=29]="glassRoad",e[e.cloud=30]="cloud",e[e.fog=31]="fog",e[e.button=32]="button",e[e.sfx_car_moving=33]="sfx_car_moving",e[e.sfx_gameover=34]="sfx_gameover",e[e.bgm=35]="bgm",e[e.sfx_absorb=36]="sfx_absorb"}(ItemType||(ItemType={}));var ItemPosition;!function(e){e[e.NONE=0]="NONE",e[e.left=1]="left",e[e.lm_center=2]="lm_center",e[e.middle=3]="middle",e[e.mr_center=4]="mr_center",e[e.right=5]="right",e[e.top_down_randomV=6]="top_down_randomV",e[e.pot_random=7]="pot_random",e[e.pot3_random=8]="pot3_random",e[e.pot2middle_random=9]="pot2middle_random",e[e.ship_leftToRight=10]="ship_leftToRight",e[e.ship_rightToLeft=11]="ship_rightToLeft",e[e.globalPlanet=12]="globalPlanet",e[e.whalePot=13]="whalePot",e[e.popScale=14]="popScale",e[e.glassRoad=15]="glassRoad",e[e.cloud_random=16]="cloud_random",e[e.cloudPos_left=17]="cloudPos_left",e[e.cloudPos_right=18]="cloudPos_right",e[e.cloudPos_around=19]="cloudPos_around",e[e.fog=20]="fog"}(ItemPosition||(ItemPosition={}));var AnimationName;!function(e){e[e.coin=0]="coin",e[e.plane1=1]="plane1",e[e.plane2=2]="plane2",e[e.globalPlanet=3]="globalPlanet",e[e.whale=4]="whale"}(AnimationName||(AnimationName={}));var CarStatus;!function(e){e[e.NONE=0]="NONE",e[e.invincible=1]="invincible",e[e.gameover=2]="gameover",e[e.absorb=4]="absorb",e[e.glassroad=8]="glassroad"}(CarStatus||(CarStatus={}));var board_end=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/ui/board_end.exml",t}return __extends(t,e),t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.killMe=function(){this.parent&&this.parent.removeChild(this),Notify.One().post(NotifyName.board_closed)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),Conf.One.play_snd(ItemType.sfx_gameover);for(var t=[this.bt_close,this.bt_rank,this.bt_revivo,this.bt_bonus],s=0;s<t.length;s++)t[s].alpha=0;this.bt_close.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this),this.bt_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this),this.bt_bonus.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this),this.bt_revivo.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this)},t}(eui.Component);__reflect(board_end.prototype,"board_end",["eui.UIComponent","egret.DisplayObject"]);var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,s){function a(a){t.call(s,a,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?a(o):RES.getResAsync(e,a,this)}else RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ui_road=function(e){function t(){var t=e.call(this)||this;return t.p_old={x:0,y:0},t.p_down=0,t.p_car={x:0,y:0},t.p_threshold=20,t.item_distance_cur=0,t.dic_chest_limit_got={},t.chest_distance_cur=0,t.skinName="resource/ui/ui_road.exml",Notify.One().add(NotifyName.car_eated,t.onNtf,t),Notify.One().add(NotifyName.car_hp_change,t.onNtf,t),Notify.One().add(NotifyName.car_speed_slowdown,t.onNtf,t),Notify.One().add(NotifyName.game_end,t.onNtf,t),Notify.One().add(NotifyName.board_closed,t.onNtf,t),t}return __extends(t,e),t.prototype.reset=function(){egret.Tween.TIMESCALE=Conf.One.tween_timescale.slow,this.ly_fog.visible=!1,this.ly_road_speedup.visible=!1,this.txt_hp.text=Conf.One.info_ph.toString(),this.txt_distance.text="0",this.ly_txtCoinCount.visible=!1,this.txtCoinCount.text="0",this.ly_blocks.visible=!1,this.mcDetectTarget.alpha=0,this.mcAbsorbTarget.alpha=0,this.road_masker.alpha=0,this.ly_pop_km.visible=!1,this.ly_board.visible=!1,Conf.One.info_km_pos={x:this.ly_pop_km.horizontalCenter,y:this.ly_pop_km.bottom},e.prototype.reset.call(this)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.reset(),this.mov_road_def.addEventListener("complete",this.onTweenGroupComplete,this),this.mov_car1.addEventListener("complete",this.onTweenGroupComplete,this),this.mov_car2.addEventListener("complete",this.onTweenGroupComplete,this),Conf.One.is_game_end=!0,this.create_cloudy_motion()},t.prototype.start_play=function(){egret.Tween.removeTweens(egret.Tween),egret.Tween.get(egret.Tween).set({TIMESCALE:Conf.One.tween_timescale.slow}).to({TIMESCALE:Conf.One.tween_timescale["default"]},800),Conf.One.play_snd(ItemType.bgm,!0),Conf.One.play_snd(ItemType.sfx_car_moving,!0),Conf.One.create_stage_level(),Conf.One.is_game_end=!1,this.mov_road_def.play(0),this.addEventListener("touchBegin",this.onTBegin,this),this.addEventListener("touchMove",this.onTMove,this),this.addEventListener("touchEnd",this.onTEnd,this),this.addEventListener(egret.Event.ENTER_FRAME,this.game_update,this)},t.prototype.game_update=function(e){if(this.status!=CarStatus.gameover){Conf.One.score_addition(),this.txt_hp.text=Math.round(Conf.One.info_ph).toString(),this.txt_distance.text=Math.round(Conf.One.gameinfo.score).toString(),this.item_distance_cur++;var t=(egret.Tween.TIMESCALE-Conf.One.tween_timescale["default"])/(Conf.One.tween_timescale.speedup-Conf.One.tween_timescale["default"]),s=.5*(this.status_sub&CarStatus.absorb?1:0),a=Math.floor(Conf.One.item_distance*(3-t-s)/3);if(this.item_distance_cur%a==0){this.item_distance_cur=0,this.chest_distance_cur++;for(var o=!1,i=0;50>i;i++){var n=!1,r=Conf.One.next_stage_level_unit();switch(r){case ItemType.chest_red_clearly:this.chest_distance_cur=0,this.dic_chest_limit_got[r]=!0,this.motion_chest(r,ItemPosition.middle),n=!0;break;case ItemType.chest_yellow_speedon_invincible:case ItemType.chest_blue_all_effect:case ItemType.chest_orange_easyGetChest:case ItemType.chest_green_addHp:case ItemType.chest_purple_secret:case ItemType.chest_girl:case ItemType.chest_tree:if(this.dic_chest_limit_got[r]&&Conf.One.gameinfo.score<200){o=!0;break}if(!this.dic_chest_limit_got[r]&&Conf.One.gameinfo.score<200){if(this.chest_distance_cur<5){o=!0;break}this.chest_distance_cur=0}this.dic_chest_limit_got[r]=!0,this.motion_chest(r,ItemPosition.pot3_random),n=!0;break;case ItemType.water1:case ItemType.well1:case ItemType.hole1:if(o)break;var _=Math.random();if(Conf.One.gameinfo.score<100&&_>.5)break;(0==(this.status_sub&CarStatus.glassroad)||_>.7&&this.status_sub&CarStatus.absorb)&&(this.create_trap(r),n=!0)}if(n){Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget,absorb:this.mcAbsorbTarget});break}}}var c=Math.floor((Conf.One.gameinfo.score+10)/100),h=Math.floor(Conf.One.gameinfo.score/75),l=Math.floor(Conf.One.gameinfo.score/24);if(c!=Conf.One.gameinfo.checkpoint&&(Conf.One.gameinfo.checkpoint=c,this.create_glassRoad()),h!=Conf.One.gameinfo.checkpoint_mov)switch(Conf.One.gameinfo.checkpoint_mov=h,Conf.One.next_rand_anm_seed()){case 0:this.create_whale();break;case 1:this.create_shipWar()}l!=Conf.One.gameinfo.checkpoint_fog&&(Conf.One.gameinfo.checkpoint_fog=l,this.create_fog())}},t.prototype.onTBegin=function(e){Conf.One.is_game_end||(this.p_down=1,this.p_old.x=e.stageX,this.p_old.y=e.stageY,this.p_car.x=this.ly_car.x,this.p_car.y=this.ly_car.y)},t.prototype.onTMove=function(e){if(!Conf.One.is_game_end&&this.p_down>0){this.p_down=2;var t=e.stageX-this.p_old.x;this.is_car_turning||(t>this.p_threshold?this.is_car_turning=!0:t<-this.p_threshold&&(this.is_car_turning=!0)),DEBUGME(DS.car_rotation)&&(this.car.rotation=-(this.ly_car.x-this.stage.stageWidth/2)/50);var s=.5;this.p_car.x+t/s<Conf.One.range_car_move.x?this.ly_car.x=Conf.One.range_car_move.x:this.p_car.x+t/s>Conf.One.range_car_move.width?this.ly_car.x=Conf.One.range_car_move.width:this.ly_car.x=this.p_car.x+t/s,Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget})}},t.prototype.onTEnd=function(e){this.p_down=0},t.prototype.game_end=function(){this.stop_cloudy(),this.removeEventListener(egret.Event.ENTER_FRAME,this.game_update,this),this.status=CarStatus.gameover,Conf.One.is_game_end=!0,this.mov_road_def.stop();var e=new board_end;this.ly_board.addChild(e),this.ly_board.visible=!0,this.ly_pots_trap.removeChildren()},t.prototype.onNtf=function(e){var t=this;switch(e.name){case NotifyName.car_eated:if(e.userdata.type>ItemType.chest_START&&e.userdata.type<ItemType.chest_END&&this.create_popInfo(e.userdata.type),this.status==CarStatus.gameover)return;switch(e.userdata.type){case ItemType.hole1:case ItemType.well1:if(this.status==CarStatus.invincible||(this.status_sub&CarStatus.glassroad)>0)return;Conf.One.play_snd(e.userdata.type),e.userdata.type==ItemType.hole1?Conf.One.gameinfo.trap_hole+=1:Conf.One.gameinfo.trap_well+=1,this.create_info_km(-60);break;case ItemType.water1:if(this.status==CarStatus.invincible||(this.status_sub&CarStatus.glassroad)>0)return;Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.trap_water+=1,this.create_visionBlock();break;case ItemType.coin:Conf.One.Coin_Collect_Total++,egret.Tween.removeTweens(this.ly_txtCoinCount),this.ly_txtCoinCount.visible=!0,egret.Tween.get(this.ly_txtCoinCount).wait(1e3).set({visible:!1}),this.txtCoinCount.text=Conf.One.Coin_Collect_Total.toString();break;case ItemType.chest_red_clearly:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.red+=1,this.car_toClearly();break;case ItemType.chest_green_addHp:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.green+=1,this.create_info_km(50);break;case ItemType.chest_orange_easyGetChest:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.orange+=1,this.absorb_chest(5);break;case ItemType.chest_yellow_speedon_invincible:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.yellow+=1,this.speedUp(5);break;case ItemType.chest_blue_all_effect:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.blue+=1,this.car_toClearly(),this.create_info_km(50),this.speedUp(5),this.absorb_chest(5);break;case ItemType.chest_purple_secret:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.secret+=1,Conf.One.set_chest_got(e.userdata.type);break;case ItemType.chest_girl:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.girl+=1,Conf.One.set_chest_got(e.userdata.type);break;case ItemType.chest_tree:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.tree+=1,Conf.One.set_chest_got(e.userdata.type)}break;case NotifyName.car_hp_change:Conf.One.score_reduce(-e.userdata.value),this.txt_hp.text=Conf.One.info_ph.toString();break;case NotifyName.car_speed_slowdown:if(this.status==CarStatus.gameover)return;egret.Tween.TIMESCALE=Conf.One.tween_timescale.trap,setInterval(function(){t.status!=CarStatus.invincible&&(egret.Tween.TIMESCALE=Conf.One.tween_timescale["default"])},800);break;case NotifyName.game_end:Conf.One.stop_snd(ItemType.sfx_car_moving),this.game_end();break;case NotifyName.board_closed:Conf.One.play_snd(ItemType.button),this.ly_board.visible=!1}},t}(ui_road_def);__reflect(ui_road.prototype,"ui_road");var ui_test=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/ui/ui_test.exml",t}return __extends(t,e),t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.motion_chest(ItemType.chest_red_clearly,ItemPosition.left)},t.prototype.motion_chest=function(e,t){var s=null;switch(e){case ItemType.chest_red_clearly:s=RES.getRes("res01_json.chest_red");break;default:s=RES.getRes("res01_json.chest_red")}var a=new egret.Bitmap(s);this.addChild(a)},t}(eui.Component);__reflect(ui_test.prototype,"ui_test",["eui.UIComponent","egret.DisplayObject"]);var Item=function(e){function t(){var t=e.call(this)||this;return t.isAnimation=!1,t.isDetected=!1,t.isDestroyed=!1,t.addEventListener(egret.Event.REMOVED,t.killMe,t),t}return __extends(t,e),t.prototype.reset=function(e,t){void 0===t&&(t=100),this.isAnimation=!1,this.type=e;var s=null;switch(this.name="Item_"+e.toString(),e){case ItemType.coin:this.anm=Conf.One.anm_load(AnimationName.coin,200*Math.random()),this.isAnimation=!0,this.anm.rotation=100*Math.random()-50;break;case ItemType.plane1:this.anm=Conf.One.anm_load(AnimationName.plane1),this.isAnimation=!0;break;case ItemType.plane2:this.anm=Conf.One.anm_load(AnimationName.plane2),this.isAnimation=!0;break;case ItemType.globalPlanet:this.anm=Conf.One.anm_load(AnimationName.globalPlanet),this.isAnimation=!0;break;case ItemType.whale:this.anm=Conf.One.anm_load(AnimationName.whale),this.isAnimation=!0;break;default:s=Conf.One.res_load(e),null==s&&console.warn("error type:"+e)}return this.isAnimation?this.addChild(this.anm):(this.img=new egret.Bitmap,this.type==ItemType.fog&&(this.img.alpha=.85),this.addChild(this.img),this.img.texture=s),this},t.prototype.motion=function(e,t,s,a){void 0===s&&(s=1),void 0===a&&(a=1);var o=this.isAnimation?this.anm:this.img,i=5e3,n=1,r=.1,_=s;switch(this.type){case ItemType.plane1:case ItemType.plane2:_=2;break;case ItemType.globalPlanet:_=2,i=5e4;break;case ItemType.coin:_=1.15,i=3e3,this.isDetected=!0;break;case ItemType.whale:_=2}if(this.isAnimation)i*=a,o.x=e.x-o.width/2,o.y=e.y-o.height/2,o.scaleX=o.scaleY=e.scaleX*_,e==t?(o.alpha=0,egret.Tween.get(o).to({alpha:1},500).wait(4*i).call(this.onTwCom,this)):egret.Tween.get(o,{onChange:this.onTwChg,onChangeObj:this}).wait(200).to({x:t.x-o.width/2*t.scaleX*_,y:t.y-o.height/2*t.scaleX*_,scaleX:t.scaleX*_,scaleY:t.scaleX*_},i).call(this.onTwCom,this),this.type==ItemType.coin&&DEBUGME(DS.able_eat_coin)&&Notify.One().add(NotifyName.car_moving,this.onNtf,this);else{i=4e3,_=.5;var c=egret.Ease.quartIn;switch(this.type){case ItemType.water1:_=1;break;case ItemType.well1:_=.9;break;case ItemType.hole1:_=.9;break;case ItemType.chest_red_clearly:case ItemType.chest_yellow_speedon_invincible:case ItemType.chest_orange_easyGetChest:case ItemType.chest_blue_all_effect:case ItemType.chest_green_addHp:case ItemType.chest_purple_secret:case ItemType.chest_girl:case ItemType.chest_tree:_=1.25;break;case ItemType.glassRoad:_=2,i=4e3;break;case ItemType.cloud:i=2e4,c=egret.Ease.sineIn,_=2;break;case ItemType.fog:n=.3,r=.6,egret.Tween.get(o).wait(i*a-500).to({alpha:0},500);break;default:_=1}switch(this.type){case ItemType.pop_blue:case ItemType.pop_green:case ItemType.pop_yellow:case ItemType.pop_orange:case ItemType.pop_red:case ItemType.pop_purple:case ItemType.pop_tree:case ItemType.pop_girl:return i=4e3,i*=a,o.x=e.x,o.y=e.y,o.scaleX=o.scaleY=.01,o.alpha=1,egret.Tween.get(o).wait(i+400).to({alpha:0},200),void egret.Tween.get(o).to({x:t.x,y:t.y,scaleX:t.scaleX,scaleY:t.scaleX},400,egret.Ease.backOut).wait(i).to({x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleX},400,egret.Ease.backIn).call(this.onTwCom,this)}switch(o.scaleX=o.scaleY=e.scaleX*_*r,o.x=e.x-o.width/2*o.scaleX,o.y=e.y-o.height/2*o.scaleX,o.alpha=0,i*=a,egret.Tween.get(o).to({alpha:n},500),egret.Tween.get(o).to({scaleX:t.scaleX*_,scaleY:t.scaleX*_},i,c),egret.Tween.get(o,{onChange:this.onTwChg,onChangeObj:this}).to({x:t.x-o.width/2*t.scaleX*_,y:t.y-o.height/2*t.scaleX*_},i,c).call(this.onTwCom,this),this.type){case ItemType.glassRoad:break;default:Notify.One().add(NotifyName.car_moving,this.onNtf,this)}}},t.prototype.onTwChg=function(e){if(!this.isDetected){var t=this.isAnimation?this.anm:this.img;if(this.isAnimation){if(this.detectTarget){var s=this.detectTarget.localToGlobal(0,0),a=new egret.Rectangle(s.x,s.y,this.detectTarget.width,this.detectTarget.height),o=t.localToGlobal(0,0);a.containsPoint(o)&&(Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0,this.killMe())}}else{if(this.absorbTarget&&Conf.One.car_status_sub&CarStatus.absorb){var s=this.absorbTarget.localToGlobal(0,0),a=new egret.Rectangle(s.x-2*this.stage.stageWidth,s.y-this.absorbTarget.height/2,5*this.stage.stageWidth,this.absorbTarget.height),o=t.localToGlobal(0,0),i=20,n=new egret.Rectangle(o.x+i,o.y+i,t.width*t.scaleX-2*i,t.height*t.scaleX-2*i);if(Conf.One.hitRect(a,n)&&this.type>ItemType.chest_START&&this.type<ItemType.chest_END)return Conf.One.play_snd(ItemType.sfx_absorb),Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0,egret.Tween.removeTweens(t),void egret.Tween.get(t).to({x:s.x,y:s.y,scaleX:.1,scaleY:.1},1e3).call(this.killMe,this)}if(this.detectTarget){var s=this.detectTarget.localToGlobal(0,0),a=new egret.Rectangle(s.x,s.y,this.detectTarget.width,this.detectTarget.height),o=t.localToGlobal(0,0),i=20,n=new egret.Rectangle(o.x+i,o.y+i,t.width*t.scaleX-2*i,t.height*t.scaleX-2*i);if(DEBUGME(DS.debug_draw_area)&&(this.graphics.clear(),this.graphics.beginFill(16711680,.8),this.graphics.drawRect(n.x,n.y,n.width,n.height),this.graphics.endFill()),Conf.One.hitRect(a,n))switch(this.type){case ItemType.hole1:case ItemType.water1:case ItemType.well1:0==(Conf.One.car_status_sub&CarStatus.glassroad)&&Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0;break;default:Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0,this.killMe()}}}}},t.prototype.fadeOutMe=function(){var e=this.isAnimation?this.anm:this.img;egret.Tween.removeTweens(e),egret.Tween.get(e).to({alpha:0},150).call(this.killMe,this)},t.prototype.stopMe=function(){var e=this.isAnimation?this.anm:this.img;egret.Tween.removeTweens(e)},t.prototype.killMe=function(){if(!this.isDestroyed){this.isDestroyed=!0,this.absorbTarget=null,this.detectTarget=null;var e=this.isAnimation?this.anm:this.img;egret.Tween.removeTweens(e),Notify.One().removeTarget(this),this.mask&&(this.mask.parent.removeChild(this.mask),this.mask=null),this.parent&&this.parent.removeChild(this)}},t.prototype.onTwCom=function(e){this.killMe()},t.prototype.onNtf=function(e){switch(e.name){case NotifyName.car_moving:this.type>ItemType.chest_START&&this.type<ItemType.trap_END&&(this.detectTarget=e.userdata.target),this.type>ItemType.chest_START&&this.type<ItemType.chest_END&&(this.absorbTarget=e.userdata.target)}},t}(egret.Sprite);__reflect(Item.prototype,"Item");