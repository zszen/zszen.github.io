function DEBUGME(e){return(debugSwitcher&e)>0}var __reflect=this&&this.__reflect||function(e,t,s){e.__class__=t,s?s.push(t):s=[t],e.__types__=e.__types__?s.concat(e.__types__):s},__extends=this&&this.__extends||function(e,t){function s(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);s.prototype=t.prototype,e.prototype=new s},__awaiter=this&&this.__awaiter||function(e,t,s,o){return new(s||(s=Promise))(function(a,i){function n(e){try{_(o.next(e))}catch(t){i(t)}}function r(e){try{_(o["throw"](e))}catch(t){i(t)}}function _(e){e.done?a(e.value):new s(function(t){t(e.value)}).then(n,r)}_((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function s(e){return function(t){return o([e,t])}}function o(s){if(a)throw new TypeError("Generator is already executing.");for(;_;)try{if(a=1,i&&(n=i[2&s[0]?"return":s[0]?"throw":"next"])&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[0,n.value]),s[0]){case 0:case 1:n=s;break;case 4:return _.label++,{value:s[1],done:!1};case 5:_.label++,i=s[1],s=[0];continue;case 7:s=_.ops.pop(),_.trys.pop();continue;default:if(n=_.trys,!(n=n.length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){_=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){_.label=s[1];break}if(6===s[0]&&_.label<n[1]){_.label=n[1],n=s;break}if(n&&_.label<n[2]){_.label=n[2],_.ops.push(s);break}n[2]&&_.ops.pop(),_.trys.pop();continue}s=t.call(e,_)}catch(o){s=[6,o],i=0}finally{a=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}var a,i,n,r,_={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),"throw":s(1),"return":s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},BoardCore=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.killMe=function(){this.parent&&this.parent.removeChild(this),Notify.One().post(NotifyName.board_closed)},t}(eui.Component);__reflect(BoardCore.prototype,"BoardCore",["eui.UIComponent","egret.DisplayObject"]);var ui_road_def=function(e){function t(){var t=e.call(this)||this;return t._status=CarStatus.NONE,t._status_sub=CarStatus.NONE,t.is_debug_board_showed=!0,t.is_car_turning=!1,t.coin_pots=[],t.dic_effect={},t.cloudy_tw=null,t.key_mov_effect=ItemType.NONE,t.speedup_road_cur=0,t.glass_cur=0,t.count_clearly=100,t}return __extends(t,e),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},set:function(e){this._status=e,Conf.One.car_status=this._status},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status_sub",{get:function(){return this._status_sub},set:function(e){this._status_sub=e,Conf.One.car_status_sub=this._status_sub},enumerable:!0,configurable:!0}),t.prototype.reset=function(){var e=this;this.mov_road_def.play(0),this.mov_road_def.stop(),this.ly_countdown.visible=!1,this.txt_status.text="",this.dic_effect[ItemType.chest_orange_easyGetChest]={layer:[this.eff_orange_back,this.eff_orange_front],mov:[this.mov_orange_back],loop:!0},this.dic_effect[ItemType.chest_blue_all_effect]={layer:[this.eff_blue_back,this.eff_blue_front],mov:[this.mov_blue_back,this.mov_blue_front1,this.mov_blue_front2],loop:!0},this.dic_effect[ItemType.chest_green_addHp]={layer:[this.eff_green_front],mov:[this.mov_green_front],loop:!1},this.dic_effect[ItemType.chest_yellow_speedon_invincible]={layer:[this.eff_yellow_front],mov:[this.mov_yellow_front1,this.mov_yellow_front2,this.mov_yellow_front3],loop:!0};for(var t in this.dic_effect)for(var s in this.dic_effect[t].layer)this.dic_effect[t].layer[s].visible=!1;DEBUGME(DS.cloudy_motion1)||(this.ly_cloudy.visible=!1),DEBUGME(DS.debug_draw_area)&&(this.mcDetectTarget.alpha=.5,this.mcAbsorbTarget.alpha=.5),DEBUGME(DS.car_clearly_first)&&this.car_clearly(!0),DEBUGME(DS.debug_button_group)?(this.bt_d_close.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),e.debug_board_display(),Conf.One.is_game_end&&e.start_play()},this),this.bt_d_coin.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_more_coins(3)},this),this.bt_d_ship.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_shipWar()},this),this.bt_d_whale.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_whale()},this),this.bt_d_hole.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_trap(ItemType.hole1)},this),this.bt_d_well.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_trap(ItemType.well1)},this),this.bt_d_water.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_trap(ItemType.water1)},this),this.bt_d_popboard.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_popInfo(ItemType.pop_red)},this),this.bt_d_glassroad.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_glassRoad()},this),this.bt_d_infokm.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_info_km(-1e3)},this),this.bt_d_fog.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_fog()},this),this.bt_d_board_start.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button);var t=new board_start;e.ly_board.addChild(t),e.ly_board.visible=!0},this),this.bt_d_board_help.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button);var t=new board_help;e.ly_board.addChild(t),e.ly_board.visible=!0},this),this.bt_d_board_gameover.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button);var t=new board_end;e.ly_board.addChild(t),e.ly_board.visible=!0},this),this.bt_d_chest1red.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button,!1),e.create_chest(ItemType.chest_red_clearly)},this),this.bt_d_chest2green.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_green_addHp)},this),this.bt_d_chest3orange.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_orange_easyGetChest)},this),this.bt_d_chest4yellow.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_yellow_speedon_invincible)},this),this.bt_d_chest5blue.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_blue_all_effect)},this),this.bt_d_chest6purple.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_purple_secret)},this),this.bt_d_chest7tree.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_tree)},this),this.bt_d_chest8girl.addEventListener(egret.TouchEvent.TOUCH_END,function(){Conf.One.play_snd(ItemType.button),e.create_chest(ItemType.chest_girl)},this),this.bt_d_game.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.start_play()},this),this.bt_d_share.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Network.One.share_revive()},this),this.bt_d_score.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Network.One.send_score()},this)):this.ly_debug_btns.visible=!1},t.prototype.mov_countdown=function(){var e=this;this.ly_countdown.visible=!0;var t=egret.Tween.get(this.ly_countdown).call(function(){e.show_countdown(3)},this).set({scaleX:.5,scaleY:1.5}).to({scaleX:1,scaleY:1},600,egret.Ease.backOut).wait(400).call(function(){e.show_countdown(2)},this).set({scaleX:.5,scaleY:1.5}).to({scaleX:1,scaleY:1},600,egret.Ease.backOut).wait(400).call(function(){e.show_countdown(1)},this).set({scaleX:.5,scaleY:1.5}).to({scaleX:1,scaleY:1},600,egret.Ease.backOut).wait(400).call(function(){e.show_countdown(0)},this).set({scaleX:.5,scaleY:1.5}).to({scaleX:1,scaleY:1},600,egret.Ease.backOut).wait(400).call(function(){e.ly_countdown.visible=!1,Notify.One().post(NotifyName.game_start)},this);t.timeScale=2.2},t.prototype.show_countdown=function(e){Conf.One.play_snd(ItemType.button);for(var t=[this.countdown_0,this.countdown_1,this.countdown_2,this.countdown_3],s=0;s<t.length;s++)e==s?t[s].visible=!0:t[s].visible=!1},t.prototype.start_play=function(){},t.prototype.start_play_real=function(){},t.prototype.absorb_chest=function(e){var t=this;null==this.mcAbsorb&&(this.mcAbsorb=new egret.Sprite,this.addChild(this.mcAbsorb)),egret.Tween.removeTweens(this.mcAbsorb),this.status_sub=this.status_sub|CarStatus.absorb,egret.Tween.get(this.mcAbsorb).wait(1e3*e*egret.Tween.TIMESCALE).call(function(){t.key_mov_effect&=~(1<<ItemType.chest_orange_easyGetChest),t.status_sub=t.status_sub&~CarStatus.absorb},this)},t.prototype.create_fog=function(){this.motion_chest(ItemType.fog,ItemPosition.fog)},t.prototype.create_cloudy_motion=function(){if(DEBUGME(DS.cloudy_motion2)){null==this.cloudy_tw&&(this.cloudy_tg=new egret.tween.TweenGroup,this.cloudy_tw=new egret.Sprite,this.ly_pots.addChild(this.cloudy_tw));for(var e=0;50>e;e++)this.motion_chest(ItemType.cloud,ItemPosition.cloudPos_around,1,Math.random());egret.Tween.get(this.cloudy_tw,{loop:!0}).wait(600).call(this.create_cloudy_motion_real,this)}else DEBUGME(DS.cloudy_motion1)&&(this.mov_cloudy.play(2e5*Math.random()),this.mov_cloudy.addEventListener("complete",this.onTweenGroupComplete,this))},t.prototype.play_effect=function(e,t,s){void 0===t&&(t=!0),void 0===s&&(s=0);var o=this.dic_effect[e];if(null!=o)if(t){this.key_mov_effect|=1<<e;for(var a in o.layer)o.layer[a].visible=!0,egret.Tween.removeTweens(o.layer[a]),egret.Tween.get(o.layer[a]).set({alpha:0}).to({alpha:1},200);for(var a in o.mov)o.mov[a].removeEventListener("complete",this.onTweenGroupComplete,this);for(var a in o.mov)o.mov[a].play(100*Math.random());for(var a in o.mov)o.mov[a].addEventListener("complete",this.onTweenGroupComplete,this)}else{this.key_mov_effect&=~(1<<e);for(var a in o.layer)egret.Tween.removeTweens(o.layer[a]),egret.Tween.get(o.layer[a]).to({alpha:0},200).set({visible:!1});for(var a in o.mov)o.mov[a].stop()}},t.prototype.create_cloudy_motion_real=function(){Math.random()<.2||this.motion_chest(ItemType.cloud,ItemPosition.cloudPos_around)},t.prototype.stop_cloudy=function(){egret.Tween.removeTweens(this.cloudy_tw);for(var e=this.cloudy_tw.numChildren-1;e>=0;e--)this.cloudy_tw.getChildAt(e).stopMe()},t.prototype.create_info_km=function(e){if(e>0)return void Notify.One().post(NotifyName.car_hp_change,{value:e});0>e&&Notify.One().post(NotifyName.car_speed_slowdown),this.ly_pop_km.visible=!0,this.ly_pop_km.alpha=1,egret.Tween.removeTweens(this.ly_pop_km),this.txt_pop_km.text=e.toString(),0>e?Conf.One.set_color(this.ly_pop_km,13113111):Conf.One.set_color(this.ly_pop_km,65328),this.ly_pop_km.bottom=Conf.One.info_km_pos.y;var t=100;egret.Tween.removeTweens(this.ly_pop_km);var s=egret.Tween.get(this.ly_pop_km).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(500).call(function(){Notify.One().post(NotifyName.car_hp_change,{value:e})}).to({bottom:Conf.One.info_km_pos.y+20,alpha:0},1e3);s.timeScale=1/egret.Tween.TIMESCALE},t.prototype.speedUp=function(e){var t=this;this.status!=CarStatus.gameover&&this.status!=CarStatus.invincible&&(this.ly_road_speedup.visible=!0,this.status=CarStatus.invincible,egret.Tween.TIMESCALE=Conf.One.tween_timescale.speedup,egret.Tween.removeTweens(this.ly_road_speedup),egret.Tween.get(this.ly_road_speedup,{loop:!0}).wait(100).call(this.speedup_roadchange,this),egret.Tween.get(this.ly_road_speedup).wait(1e3*e*egret.Tween.TIMESCALE).call(function(){t.key_mov_effect&=~(1<<ItemType.chest_yellow_speedon_invincible|1<<ItemType.chest_blue_all_effect),egret.Tween.TIMESCALE=Conf.One.tween_timescale["default"],t.status=CarStatus.NONE,egret.Tween.removeTweens(t.ly_road_speedup),t.ly_road_speedup.visible=!1},this))},t.prototype.speedup_roadchange=function(){this.speedup_road_cur++%2==0?(this.road_speed1.visible=!1,this.road_speed2.visible=!0):(this.road_speed2.visible=!1,this.road_speed1.visible=!0)},t.prototype.create_whale=function(){this.motion_chest(ItemType.whale,ItemPosition.whalePot)},t.prototype.create_shipWar=function(){var e=this;this.mcShipwar||(this.mcShipwar=new egret.Sprite,this.addChild(this.mcShipwar)),this.motion_chest(ItemType.globalPlanet,ItemPosition.globalPlanet),egret.Tween.removeTweens(this.mcShipwar),egret.Tween.get(this.mcShipwar).wait(500).call(function(){e.motion_chest(ItemType.plane2,ItemPosition.ship_rightToLeft)}).wait(200).call(function(){e.motion_chest(ItemType.plane1,ItemPosition.ship_leftToRight)}).wait(3e3).call(function(){egret.Tween.removeTweens(e.mcShipwar)},this)},t.prototype.create_visionBlock=function(){this.ly_blocks.visible=!0,this.ly_blocks.alpha=0,egret.Tween.get(this.ly_blocks).to({alpha:1},400).wait(2e3).to({alpha:0},900).set({visible:!1})},t.prototype.create_trap=function(e){if(!(this.status_sub&CarStatus.glassroad_ready||this.status&CarStatus.gameover)){switch(e){case ItemType.well1:Math.random()>.85?(this.motion_chest(e,ItemPosition.left),this.motion_chest(e,ItemPosition.right)):this.motion_chest(e,ItemPosition.pot3_random);break;default:this.motion_chest(e,ItemPosition.pot2middle_random)}Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget,absorb:this.mcAbsorbTarget})}},t.prototype.create_chest=function(e){this.motion_chest(e,ItemPosition.pot3_random),Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget,absorb:this.mcAbsorbTarget})},t.prototype.create_popInfo=function(e){for(var t=this.ly_popboard.numChildren-1;t>=0;t--){var s=this.ly_popboard.getChildAt(t);s&&s.fadeOutMe()}switch(e){case ItemType.chest_red_clearly:this.motion_chest(ItemType.pop_red,ItemPosition.popScale);break;case ItemType.chest_blue_all_effect:this.motion_chest(ItemType.pop_blue,ItemPosition.popScale);break;case ItemType.chest_green_addHp:this.motion_chest(ItemType.pop_green,ItemPosition.popScale);break;case ItemType.chest_yellow_speedon_invincible:this.motion_chest(ItemType.pop_yellow,ItemPosition.popScale);break;case ItemType.chest_orange_easyGetChest:this.motion_chest(ItemType.pop_orange,ItemPosition.popScale);break;case ItemType.chest_purple_secret:this.motion_chest(ItemType.pop_purple,ItemPosition.popScale);break;case ItemType.chest_girl:this.motion_chest(ItemType.pop_girl,ItemPosition.popScale);break;case ItemType.chest_tree:this.motion_chest(ItemType.pop_tree,ItemPosition.popScale);break;default:this.motion_chest(e,ItemPosition.popScale)}},t.prototype.create_glassRoad=function(e){var t=this;void 0===e&&(e=15),this.status_sub=this.status_sub|CarStatus.glassroad_ready,this.glass_cur=e,null==this.glass_tw_obj&&(this.glass_tw_obj=new egret.Sprite,this.addChild(this.glass_tw_obj)),egret.Tween.removeTweens(this.glass_tw_obj),egret.Tween.get(this.glass_tw_obj).wait(1e3*egret.Tween.TIMESCALE).call(function(){egret.Tween.get(t.glass_tw_obj,{loop:!0}).wait(280).call(t.create_glass_road_real,t)},this).wait(4e3*egret.Tween.TIMESCALE).call(function(){t.status_sub=t.status_sub|CarStatus.glassroad_show},this)},t.prototype.create_glass_road_real=function(){var e=this;this.glass_cur>0?(this.glass_cur--,this.motion_chest(ItemType.glassRoad,ItemPosition.glassRoad)):(egret.Tween.removeTweens(this.glass_tw_obj),egret.Tween.get(this.glass_tw_obj).wait(1e3*egret.Tween.TIMESCALE).call(function(){e.status_sub=e.status_sub&~CarStatus.glassroad_ready,e.status_sub=e.status_sub&~CarStatus.glassroad_show},this))},t.prototype.create_more_coins=function(e){var t=this;null==this.mcCoin&&(this.mcCoin=new egret.Sprite,this.addChild(this.mcCoin)),egret.Tween.get(this.mcCoin).wait(1e3*e).call(function(){egret.Tween.removeTweens(t.mcCoin)},this),egret.Tween.get(this.mcCoin,{loop:!0}).wait(280).call(this.create_more_coins_real,this)},t.prototype.create_more_coins_real=function(){this.coin_pots=Conf.One.coin_next_group();for(var e=0;e<this.coin_pots.length;e++)this.motion_chest(ItemType.coin,ItemPosition.top_down_randomV,1,this.coin_pots[e]);Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget,absorb:this.mcAbsorbTarget})},t.prototype.car_toClearly=function(){var e=this,t=50;egret.Tween.removeTweens(this.car),egret.Tween.get(this.car).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).call(function(){e.car_clearly(!0)},this).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t).set({visible:!1}).wait(t).set({visible:!0}).wait(t)},t.prototype.car_clearly=function(e){e?this.car.source="res01_json.car":this.car.source="res01_json.car_masaka"},t.prototype.onTweenGroupComplete=function(e){for(var t in this.dic_effect)for(var s in this.dic_effect[t].mov)if(e.target==this.dic_effect[t].mov[s]){var o=1<<parseInt(t);return void(this.dic_effect[t].loop&&this.key_mov_effect&o?e.target.play(0):this.play_effect(parseInt(t),!1))}switch(e.target){case this.mov_road_def:case this.mov_cloudy:e.target.play(0);break;default:this.is_car_turning=!1}},t.prototype.debug_board_display=function(){this.is_debug_board_showed=!this.is_debug_board_showed;for(var e=this.ly_debug_btns.numChildren-1;e>=0;e--){var t=this.ly_debug_btns.getChildAt(e);t!=this.bt_d_close&&t!=this.txt_status&&(t.visible=this.is_debug_board_showed)}},t.prototype.motion_chest=function(e,t,s,o){void 0===s&&(s=1);var a={x:0,y:0,scaleX:1},i={x:0,y:0,scaleX:1},n=1;if(t==ItemPosition.pot3_random){var r=[ItemPosition.left,ItemPosition.middle,ItemPosition.right];t=r[Math.floor(Math.random()*r.length)]}else if(t==ItemPosition.pot2middle_random){var _=[ItemPosition.lm_center,ItemPosition.mr_center];t=_[Math.floor(Math.random()*_.length)]}else if(t==ItemPosition.cloud_random){var c=[ItemPosition.cloudPos_left,ItemPosition.cloudPos_right];t=c[Math.floor(Math.random()*c.length)]}switch(t){case ItemPosition.left:a.x=this.p_start1.x,a.y=this.stage.stageHeight-this.p_start1.bottom,a.scaleX=this.p_start1.scaleX;break;case ItemPosition.lm_center:a.x=(this.p_start1.x+this.p_start2.x)/2,a.y=this.stage.stageHeight-this.p_start1.bottom,a.scaleX=this.p_start1.scaleX;break;case ItemPosition.middle:a.x=this.p_start2.x,a.y=this.stage.stageHeight-this.p_start2.bottom,a.scaleX=this.p_start2.scaleX;break;case ItemPosition.mr_center:a.x=(this.p_start2.x+this.p_start3.x)/2,a.y=this.stage.stageHeight-this.p_start3.bottom,a.scaleX=this.p_start3.scaleX;break;case ItemPosition.right:a.x=this.p_start3.x,a.y=this.stage.stageHeight-this.p_start3.bottom,a.scaleX=this.p_start3.scaleX;break;case ItemPosition.top_down_randomV:a.x=o,a.y=0,a.scaleX=1;break;case ItemPosition.ship_leftToRight:a.x=this.p_start4.x,a.y=this.p_start4.top,a.scaleX=this.p_start4.scaleX;break;case ItemPosition.ship_rightToLeft:a.x=this.p_start5.x,a.y=this.p_start5.top,a.scaleX=this.p_start5.scaleX;break;case ItemPosition.whalePot:a.x=this.p_start6.x,a.y=this.stage.stageHeight-this.p_start6.bottom,a.scaleX=this.p_start6.scaleX;break;case ItemPosition.globalPlanet:a.x=this.p_start2.x,a.y=this.stage.stageHeight-this.p_start2.bottom,a.scaleX=this.p_start2.scaleX;break;case ItemPosition.popScale:a.x=this.stage.stageWidth/2,a.y=this.ly_popboard.height/2,a.scaleX=0;break;case ItemPosition.glassRoad:a.x=this.p_start2.x,a.y=this.stage.stageHeight-this.p_start2.bottom,a.scaleX=1.2;break;case ItemPosition.cloudPos_left:a.x=this.p_start1.x,a.y=this.stage.stageHeight-this.p_start1.bottom-50,a.scaleX=0;break;case ItemPosition.cloudPos_right:a.x=this.p_start3.x,a.y=this.stage.stageHeight-this.p_start3.bottom-50,a.scaleX=0;break;case ItemPosition.cloudPos_around:a.x=this.p_start2.x,a.y=this.stage.stageHeight-this.p_start3.bottom-50,a.scaleX=0;break;case ItemPosition.fog:a.x=this.p_start2.x,a.y=this.stage.stageHeight-this.p_start2.bottom,a.scaleX=this.p_start2.scaleX}switch(t){case ItemPosition.left:i.x=this.p_end1.x,i.y=this.stage.stageHeight-this.p_end1.bottom,i.scaleX=this.p_end1.scaleX;break;case ItemPosition.lm_center:i.x=this.p_end2.x,i.y=this.stage.stageHeight-this.p_end2.bottom,i.scaleX=this.p_end2.scaleX;break;case ItemPosition.middle:i.x=this.p_end3.x,i.y=this.stage.stageHeight-this.p_end3.bottom,i.scaleX=this.p_end3.scaleX;break;case ItemPosition.mr_center:i.x=this.p_end4.x,i.y=this.stage.stageHeight-this.p_end4.bottom,i.scaleX=this.p_end4.scaleX;break;case ItemPosition.right:i.x=this.p_end5.x,i.y=this.stage.stageHeight-this.p_end5.bottom,i.scaleX=this.p_end5.scaleX;break;case ItemPosition.top_down_randomV:i.x=a.x,i.y=this.ly_pots.height,i.scaleX=1;break;case ItemPosition.ship_leftToRight:i=a;break;case ItemPosition.ship_rightToLeft:i=a;break;case ItemPosition.whalePot:i=a;break;case ItemPosition.popScale:i.scaleX=2;break;case ItemPosition.glassRoad:i.x=this.p_end3.x,i.y=1.5*this.stage.stageHeight-this.p_end3.bottom,i.scaleX=this.p_end5.scaleX;break;case ItemPosition.cloudPos_left:i.x=a.x-4*this.stage.stageWidth,i.y=a.y+(Math.random()-.5)*this.stage.stageHeight*5,i.scaleX=this.p_end1.scaleX;break;case ItemPosition.cloudPos_right:i.x=a.x+4*this.stage.stageWidth,i.y=a.y+(Math.random()-.5)*this.stage.stageHeight*5,i.scaleX=this.p_end1.scaleX;break;case ItemPosition.cloudPos_around:var h=2*this.stage.stageHeight,l=Math.PI/180*(Math.random()-.5)*230;i.x=a.x+Math.sin(l)*h,i.y=a.y-Math.cos(l)*h,i.scaleX=this.p_end1.scaleX,null!=o&&o>0&&1>=o&&(a.x+=(i.x-a.x)*o,a.y+=(i.y-a.y)*o,a.scaleX+=(i.scaleX-a.scaleX)*o*10,n=1-o);break;case ItemPosition.fog:i.x=this.p_end3.x+300*(Math.random()-.5),i.y=a.y+.7*(this.p_end3.y-a.y),i.scaleX=2*this.p_end3.scaleX;break;case ItemPosition.globalPlanet:default:i=a}var p=(new Item).reset(e);switch(t==ItemPosition.popScale&&(i.x=(this.stage.stageWidth-p.width*i.scaleX)/2,i.y=(this.ly_popboard.height-p.height*i.scaleX)/2),e){case ItemType.glassRoad:this.ly_pots_glassroad.addChild(p);var d=new eui.Image("res02_json.road_bg");this.addChild(d),d.alpha=1,d.horizontalCenter=this.road_masker.horizontalCenter,d.bottom=this.road_masker.bottom,d.width=this.road_masker.width,d.height=this.road_masker.height,p.mask=d;break;case ItemType.globalPlanet:case ItemType.whale:this.ly_pots_planet.addChild(p);break;case ItemType.well1:case ItemType.water1:case ItemType.hole1:this.ly_pots_trap.addChild(p);break;case ItemType.pop_blue:case ItemType.pop_green:case ItemType.pop_yellow:case ItemType.pop_orange:case ItemType.pop_red:case ItemType.pop_purple:case ItemType.pop_tree:case ItemType.pop_girl:this.ly_popboard.addChild(p);break;case ItemType.cloud:DEBUGME(DS.cloudy_motion2)&&this.cloudy_tw.addChildAt(p,0);break;case ItemType.fog:this.ly_pots.addChild(p),s=6;break;default:this.ly_pots.addChildAt(p,0)}t!=ItemPosition.NONE&&p.motion(a,i,s,n)},t}(eui.Component);__reflect(ui_road_def.prototype,"ui_road_def",["eui.UIComponent","egret.DisplayObject"]);var NotifyName=function(){function e(){}return e.car_moving="car_moving",e.car_eated="car_eated",e.car_speed_slowdown="car_speed_slowdown",e.car_hp_change="car_hp_change",e.board_closed="board_closed",e.game_ready="game_ready",e.game_countdown="game_countdown",e.game_start="game_start",e.game_end="game_end",e.game_revive="game_revivo",e.game_score_rank="game_score_rank",e.display_index="display_index",e.display_game="display_game",e.display_rank="display_rank",e.display_bonus="display_bonus",e}();__reflect(NotifyName.prototype,"NotifyName");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,s,o){function a(e){t.call(o,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),s.call(o))}var n=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(o,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,s){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(o,generateEUI2)},n)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var r=e.split("/");r.pop();var _=r.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(o,generateJSON.paths[e])},this):RES.getResByUrl(_,function(s){window.JSONParseClass.setData(s),egret.callLater(function(){t.call(o,generateJSON.paths[e])},n)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(o,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,s){function o(o){t.call(s,o,e)}if(RES.hasRes(e)){var a=RES.getRes(e);a?o(a):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Conf=function(){function e(){this.is_game_end=!0,this.info_km_pos={x:0,y:0},this.info_is_addedlife=!1,this.Coin_Collect_Total=0,this.Revive_Times=0,this.range_car_move=new egret.Rectangle(100,0,0,0),this.coin_rand_pot=0,this.coin_pot_cur=0,this.coin_pots_odd=[],this.coin_pots_even=[],this.item_distance=18,this.animation_random_seed=0,this.framerate=30,this.km_max=490,this.game_time_spend=10,this.tween_timescale={"default":1.5,speedup:2.5,trap:.3,slow:.5},this.gameinfo={score:0,scoreAndFrame:0,total:0,totalVirtuall:0,checkpoint:0,checkpoint_mov:0,checkpoint_fog:0,green:0,blue:0,girl:0,tree:0,secret:0,red:0,orange:0,yellow:0,trap_water:0,trap_hole:0,trap_well:0},this.dic_item_type={},this.dic_item_name={},this.dic_sfxs={},this.level_data={},this.stage_level_firstOne=!0,this.coin_cur_odd=!0,this.cloud_ran_cur=0,Network.One,window.document.conf=this}return e.prototype.reset=function(e){this.STAGE=e,egret.Tween.TIMESCALE=this.tween_timescale["default"],this.animation_random_seed=Math.floor(3*Math.random());for(var t in this.gameinfo)this.gameinfo[t]=0;this.init_chest_info(),this.gameinfo.total=this.km_max*this.framerate,this.gameinfo.totalVirtuall=this.gameinfo.total,this.is_game_end=!1,this.Coin_Collect_Total=0,this.Revive_Times=1,this.range_car_move.width=this.STAGE.stageWidth-this.range_car_move.x,this.info_is_addedlife=!1,this.coin_pots_odd=[],this.coin_pots_even=[];for(var s=6,o=50,a=(this.STAGE.stageWidth-2*o)/(s-1),i=0;s>i;i++)i%2==1?this.coin_pots_odd.push(i*a+o):this.coin_pots_even.push(i*a+o)},e.prototype.init_chest_info=function(){this.dic_item_type[ItemType.chest_red_clearly]="颜值宝箱",this.dic_item_type[ItemType.chest_green_addHp]="续航宝箱",this.dic_item_type[ItemType.chest_orange_easyGetChest]="安全宝箱",this.dic_item_type[ItemType.chest_yellow_speedon_invincible]="动力宝箱",this.dic_item_type[ItemType.chest_orange_easyGetChest]="安全宝箱",this.dic_item_type[ItemType.chest_blue_all_effect]="品质宝箱",this.dic_item_type[ItemType.chest_purple_secret]="神秘宝箱",this.dic_item_type[ItemType.chest_girl]="女神宝箱",this.dic_item_type[ItemType.chest_tree]="公益宝箱",this.dic_item_type[ItemType.well1]="井盖",this.dic_item_type[ItemType.hole1]="深坑",this.dic_item_type[ItemType.water1]="水坑";for(var e in this.dic_item_type)this.dic_item_name[this.dic_item_type[e]]=parseInt(e);for(var e in this.dic_item_name)e!=this.Game_type2name(this.Game_name2type(e))&&console.error("wrong type name set::"+e)},e.prototype.Game_name2type=function(e){return this.dic_item_name[e]?this.dic_item_name[e]:ItemType.NONE},e.prototype.Game_type2name=function(e){return this.dic_item_type[e]?this.dic_item_type[e]:null},e.prototype.rank_res=function(e){return 1>=e?"res01_json.board_end_title_1":10>=e?"res01_json.board_end_title_2":50>=e?"res01_json.board_end_title_3":100>=e?"res01_json.board_end_title_4":"res01_json.board_end_title_5"},e.prototype.Game_ate_nameCount=function(e){var t=this.Game_name2type(e);switch(t){case ItemType.chest_red_clearly:return this.gameinfo.red;case ItemType.chest_yellow_speedon_invincible:return this.gameinfo.yellow;case ItemType.chest_orange_easyGetChest:return this.gameinfo.orange;case ItemType.chest_green_addHp:return this.gameinfo.green;case ItemType.chest_blue_all_effect:return this.gameinfo.blue;case ItemType.chest_purple_secret:return this.gameinfo.secret;case ItemType.chest_tree:return this.gameinfo.tree;case ItemType.chest_girl:return this.gameinfo.girl;case ItemType.water1:return this.gameinfo.trap_water;case ItemType.well1:return this.gameinfo.trap_well;case ItemType.hole1:return this.gameinfo.trap_hole}},e.prototype.play_snd=function(e,t){void 0===t&&(t=!1);var s;switch(e){case ItemType.chest_red_clearly:s="sfx_good_mp3";break;case ItemType.chest_green_addHp:s="sfx_good_mp3";break;case ItemType.chest_blue_all_effect:s="sfx_good2_mp3";break;case ItemType.chest_orange_easyGetChest:s="sfx_good_mp3";break;case ItemType.chest_yellow_speedon_invincible:s="sfx_good_mp3";break;case ItemType.chest_girl:s="sfx_good4_mp3";break;case ItemType.chest_tree:s="sfx_good4_mp3";break;case ItemType.chest_purple_secret:s="sfx_good3_mp3";break;case ItemType.hole1:s="sfx_car_break_01_mp3";break;case ItemType.well1:s="sfx_car_break_01_mp3";break;case ItemType.water1:s="sfx_water_splash_mp3";break;case ItemType.sfx_car_moving:s="sfx_car_move_loop_mp3";break;case ItemType.sfx_gameover:s="sfx_success1_mp3";break;case ItemType.button:s="sfx_bubble_mp3";break;case ItemType.bgm:s="bgm_mp3";break;case ItemType.sfx_absorb:s="sfx_absorb_mp3"}if(s){var o=RES.getRes(s);o?t?(this.dic_sfxs[e]&&this.dic_sfxs[e].stop(),this.dic_sfxs[e]=o.play(0,-1)):o.play(0,1):console.warn(s+" NULL !!!")}},e.prototype.stop_snd=function(e){this.dic_sfxs[e]&&(this.dic_sfxs[e].stop(),delete this.dic_sfxs[e])},e.prototype.stopAll_snd=function(){for(var e in this.dic_sfxs)this.dic_sfxs[e]&&this.dic_sfxs[e].stop();this.dic_sfxs={}},Object.defineProperty(e.prototype,"info_ph",{get:function(){return Math.round(this.gameinfo.total/this.framerate)},set:function(e){this.gameinfo.total+=e*this.framerate},enumerable:!0,configurable:!0}),e.prototype.level_unit_on_km=function(e){return this.level_data[e]?this.level_data[e]:ItemType.NONE},e.prototype.reset_revive=function(){return this.Revive_Times<=0?!1:(this.Revive_Times-=1,this.gameinfo.total=this.km_max*this.framerate,this.gameinfo.totalVirtuall=this.gameinfo.total,!0)},e.prototype.create_stage_level=function(){if(!Network.One.data_info)return!1;var t=Network.One.data_info.Data.Box.FunctionBoxes,s=Network.One.data_info.Data.Box.GiftBoxes,o=0,a=0;for(var i in t)switch(e.One.Game_name2type(t[i].Name)){case ItemType.chest_blue_all_effect:case ItemType.chest_green_addHp:o+=parseInt(t[i].Count);break;case ItemType.water1:case ItemType.hole1:case ItemType.well1:a+=parseInt(t[i].Count)}var n={};for(var i in t){var r=e.One.Game_name2type(t[i].Name);switch(n[r]=parseInt(t[i].Count),e.One.Game_name2type(t[i].Name)){case ItemType.chest_blue_all_effect:case ItemType.chest_green_addHp:case ItemType.chest_yellow_speedon_invincible:case ItemType.chest_orange_easyGetChest:n[r]-=1;break;case ItemType.chest_red_clearly:n[r]=0}}for(var i in s){var r=e.One.Game_name2type(s[i].Name);n[r]=parseInt(s[i].Count)}var _=this.km_max+50*o,c=[ItemType.chest_blue_all_effect,ItemType.chest_orange_easyGetChest,ItemType.chest_green_addHp,ItemType.chest_yellow_speedon_invincible];if(c.sort(function(){return Math.random()-.5}),c.unshift(ItemType.chest_red_clearly),console.log("trap count "+a),console.log("km add count "+o),!DEBUGME(DS.no_trap)){var h=100;
DEBUGME(DS.no_chest)&&(h=0);for(var l=Math.floor((_-h)/a),p=0;a>p;p++){var d=Math.floor(3*Math.random());switch(d){case 0:this.level_data[p*l+h]=ItemType.water1,n[ItemType.water1]-=1;break;case 1:this.level_data[p*l+h]=ItemType.hole1,n[ItemType.hole1]-=1;break;case 2:this.level_data[p*l+h]=ItemType.well1,n[ItemType.well1]-=1}}delete n[ItemType.water1],delete n[ItemType.well1],delete n[ItemType.hole1],delete n[ItemType.chest_red_clearly]}if(!DEBUGME(DS.no_chest)){for(var p=0;p<c.length;p++)this.level_data[40*p]=c[p];for(var m=[ItemType.chest_blue_all_effect,ItemType.chest_yellow_speedon_invincible,ItemType.chest_orange_easyGetChest,ItemType.chest_green_addHp,ItemType.chest_purple_secret,ItemType.chest_girl,ItemType.chest_tree],u=0,p=0;p<m.length;p++)u+=n[m[p]];for(var f=200,y=Math.floor((_-f)/u),p=0;u>p;p++){var d=Math.floor(Math.random()*m.length),r=m[d];n[r]-=1,this.level_data[p*y+f]=m[d];for(var g=-3;3>=g;g++)0!=g&&delete this.level_data[p*y+f+g];0>=n&&(delete n[r],m.splice(d,1))}}return console.log(this.level_data),!0},e.prototype.next_rand_anm_seed=function(){var e=3;return this.animation_random_seed=(this.animation_random_seed+Math.floor(Math.random()*(e-1))+1)%e,this.animation_random_seed},e.prototype.get_able_revive=function(){return this.Revive_Times<=0},e.prototype.set_chest_got=function(e){switch(e){case ItemType.chest_purple_secret:this.chest_secret_max=Math.max(0,this.chest_secret_max-1),this.gameinfo.secret+=1;break;case ItemType.chest_girl:this.chest_girl_max=Math.max(0,this.chest_girl_max-1),this.gameinfo.girl+=1;break;case ItemType.chest_tree:this.chest_tree_max=Math.max(0,this.chest_tree_max-1),this.gameinfo.tree+=1}},e.prototype.score_reduce=function(e){return this.gameinfo.total-=e*this.framerate,this.gameinfo.total<=0&&(this.gameinfo.total=0,this.is_game_end=!0,Notify.One().post(NotifyName.game_end)),this.info_ph},e.prototype.score_addition=function(){return this.gameinfo.total-this.game_time_spend<0?(this.gameinfo.total=0,void Notify.One().post(NotifyName.game_end)):(this.gameinfo.total-=this.game_time_spend,this.gameinfo.scoreAndFrame+=this.game_time_spend,void(this.gameinfo.score=Math.round(this.gameinfo.scoreAndFrame/this.framerate)))},e.prototype.coin_rand=function(){for(var e=this.coin_pot_cur,t=0;5>t;t++)e==this.coin_pot_cur&&(this.coin_pot_cur=Math.floor(Math.random()*this.coin_pots_odd.length));return this.coin_rand_pot=this.coin_pots_odd[this.coin_pot_cur],this.coin_rand_pot},e.prototype.coin_next_group=function(){return this.coin_cur_odd=!this.coin_cur_odd,this.coin_cur_odd?this.coin_pots_odd:this.coin_pots_even},e.prototype.anm_load=function(e,t){void 0===t&&(t=0);var s=RES.getRes("anm1_ske_json"),o=RES.getRes("anm1_tex_png"),a=RES.getRes("anm1_tex_json"),i=new dragonBones.EgretFactory;i.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(s)),i.addTextureAtlas(new dragonBones.EgretTextureAtlas(o,a));var n;switch(e){case AnimationName.coin:n=i.buildArmatureDisplay("anm1"),n.animation.gotoAndPlayByTime("coin",t);break;case AnimationName.globalPlanet:n=i.buildArmatureDisplay("anm1"),n.animation.play("planet",1);break;case AnimationName.plane1:n=i.buildArmatureDisplay("plane1_fly"),n.animation.play("newAnimation",1);break;case AnimationName.plane2:n=i.buildArmatureDisplay("plane2_fly"),n.animation.play("newAnimation",1);break;case AnimationName.whale:n=i.buildArmatureDisplay("anm1"),n.animation.play("whale",1)}return n},e.prototype.res_load=function(e){var t=null;switch(e){case ItemType.chest_red_clearly:t=RES.getRes("res01_json.chest_red");break;case ItemType.chest_green_addHp:t=RES.getRes("res01_json.chest_green");break;case ItemType.chest_yellow_speedon_invincible:t=RES.getRes("res01_json.chest_yellow");break;case ItemType.chest_orange_easyGetChest:t=RES.getRes("res01_json.chest_orange");break;case ItemType.chest_blue_all_effect:t=RES.getRes("res01_json.chest_blue");break;case ItemType.chest_purple_secret:t=RES.getRes("res01_json.chest_purple");break;case ItemType.chest_tree:t=RES.getRes("res01_json.chest_tree");break;case ItemType.chest_girl:t=RES.getRes("res01_json.chest_girl");break;case ItemType.hole1:t=RES.getRes("res01_json.hole_1");break;case ItemType.well1:t=RES.getRes("res01_json.well_1");break;case ItemType.water1:t=RES.getRes("res01_json.water_1");break;case ItemType.pop_blue:t=RES.getRes("res01_json.pop_blue");break;case ItemType.pop_red:t=RES.getRes("res01_json.pop_red");break;case ItemType.pop_green:t=RES.getRes("res01_json.pop_green");break;case ItemType.pop_yellow:t=RES.getRes("res01_json.pop_yellow");break;case ItemType.pop_orange:t=RES.getRes("res01_json.pop_orange");break;case ItemType.pop_purple:t=RES.getRes("res01_json.pop_purple");break;case ItemType.pop_tree:t=RES.getRes("res01_json.pop_tree");break;case ItemType.pop_girl:t=RES.getRes("res01_json.pop_girl");break;case ItemType.glassRoad:t=RES.getRes("res01_json.glass_1");break;case ItemType.fog:t=RES.getRes("res01_json.fog");break;case ItemType.cloud:var s=["res01_json.cloud_1","res01_json.cloud_3"];this.cloud_ran_cur+=Math.random()>.5?1:2,t=RES.getRes(s[this.cloud_ran_cur%s.length]);break;default:console.log("res "+e+" don't config")}return t},e.prototype.hitRect=function(e,t){if(e.contains(t.topLeft.x,t.topLeft.y)||e.contains(t.topLeft.x+t.width,t.topLeft.y)||e.contains(t.topLeft.x,t.topLeft.y+t.height)||e.contains(t.topLeft.x+t.width,t.topLeft.y+t.height))return!0;var s=t;return t=e,e=s,e.contains(t.topLeft.x,t.topLeft.y)||e.contains(t.topLeft.x+t.width,t.topLeft.y)||e.contains(t.topLeft.x,t.topLeft.y+t.height)||e.contains(t.topLeft.x+t.width,t.topLeft.y+t.height)?!0:!1},e.prototype.set_color=function(e,t){var s=function(e){var t={r:0,g:0,b:0};return t.b=e%256,t.g=Math.floor(e/256)%256,t.r=Math.floor(e/256/256),t},o=s(t),a=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];a[0]=o.r/255,a[6]=o.g/255,a[12]=o.b/255;var i=new egret.ColorMatrixFilter(a);e.filters=[i]},Object.defineProperty(e,"One",{get:function(){return this._s?this._s:(this._s=new e,this._s)},enumerable:!0,configurable:!0}),e}();__reflect(Conf.prototype,"Conf");var Network=function(){function e(){window.document.network=this}return Object.defineProperty(e.prototype,"data_info",{get:function(){return this._data_info},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data_score_rank",{get:function(){return this._data_score_rank},enumerable:!0,configurable:!0}),e.prototype.start_game=function(){JS_start_game({},this.start_game_callback,this)},e.prototype.start_game_callback=function(e){this.varify_data_success(e)?this._data_info=e:console.error("start game page error"),DEBUGME(DS.skip_countdown)?Notify.One().post(NotifyName.game_start):Notify.One().post(NotifyName.game_countdown)},e.prototype.share_revive=function(){JS_share_revive({},this.share_revive_callback,this)},e.prototype.share_revive_callback=function(e){this.varify_data_success(e)?this._data_info=e:console.error("revive game page error"),Notify.One().post(NotifyName.game_revive)},e.prototype.send_score=function(){var t=[];if(this._data_info){for(var s=this._data_info.Data.Box.FunctionBoxes,o=this._data_info.Data.Box.GiftBoxes,a=(ItemType.chest_red_clearly,0);a<s.length;a++)t.push({Code:s[a].Code,Count:Conf.One.Game_ate_nameCount(s[a].Name)});for(var a=0;a<o.length;a++)t.push({Code:o[a].Code,Count:Conf.One.Game_ate_nameCount(o[a].Name)})}JS_send_score({TotalKM:Conf.One.gameinfo.score,UsedBoxes:t},e.One.score_callback,e.One)},e.prototype.score_callback=function(e){console.log(e),this._data_score_rank=e,Notify.One().post(NotifyName.game_score_rank)},e.prototype.varify_data_success=function(e){return null!=e&&1==e.Success?!0:!1},e.prototype.getUrl=function(e){window.location.href=e},Object.defineProperty(e,"One",{get:function(){return this._s?this._s:(this._s=new e,this._s)},enumerable:!0,configurable:!0}),e}();__reflect(Network.prototype,"Network");var Notify=function(){function e(){this.dicNtfs={},console.log("Notify::Init")}return e.One=function(){return null==this.__single&&(this.__single=new e),this.__single},e.prototype.post=function(e,t){if(void 0===t&&(t=null),null!=this.dicNtfs[e])for(var s=this.dicNtfs[e],o=0;o<s.length;o++)s[o].post(t)},e.prototype.add=function(e,t,s){if(null!=s&&null!=t){null==this.dicNtfs[e]&&(this.dicNtfs[e]=[]);for(var o in this.dicNtfs[e])if(this.dicNtfs[e].hasOwnProperty(o)&&this.dicNtfs[e][o].target==s)return void console.warn("Notify::Add::Repeat::"+e);var a=new NotifyObserve(e,s,t);this.dicNtfs[e].push(a)}},e.prototype.clear=function(){for(var e in this.dicNtfs)for(var t=this.dicNtfs[e],s=t.length-1;s>=0;s--)t[s].clear();this.dicNtfs={}},e.prototype.removeName=function(e){for(var t in this.dicNtfs)if(e==t){for(var s=this.dicNtfs[t],o=s.length-1;o>=0;o--)s[o].clear();this.dicNtfs[t]=null,delete this.dicNtfs[t]}},e.prototype.removeTarget=function(e){for(var t in this.dicNtfs)for(var s=this.dicNtfs[t],o=s.length-1;o>=0;o--)s[o].target==e&&(s[o].clear(),s.splice(o,1))},e}();__reflect(Notify.prototype,"Notify");var NotifyObserve=function(){function e(e,t,s){this.target=t,this.name=e,this.func=s}return e.prototype.post=function(e){this.userdata=e,this.func.call(this.target,this)},e.prototype.clear=function(){this.target=null,this.name=null,this.func=null,this.userdata=null},e}();__reflect(NotifyObserve.prototype,"NotifyObserve");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var DM;!function(e){e[e.debug=1]="debug",e[e.demo=2]="demo",e[e.release=4]="release"}(DM||(DM={}));var DS;!function(e){e[e.NONE=0]="NONE",e[e.car_clearly_first=1]="car_clearly_first",e[e.debug_draw_area=2]="debug_draw_area",e[e.debug_button_group=4]="debug_button_group",e[e.able_eat_coin=8]="able_eat_coin",e[e.cloudy_motion1=16]="cloudy_motion1",e[e.cloudy_motion2=32]="cloudy_motion2",e[e.car_rotation=64]="car_rotation",e[e.debug_item_show=128]="debug_item_show",e[e.show_board_start=256]="show_board_start",e[e.show_board_end=512]="show_board_end",e[e.show_board_help=1024]="show_board_help",e[e.fake_number=2048]="fake_number",e[e.skip_countdown=4096]="skip_countdown",e[e.no_chest=8192]="no_chest",e[e.no_trap=16384]="no_trap",e[e.debug_move=32768]="debug_move",e[e.show_status=65536]="show_status"}(DS||(DS={}));var debugMode=DM.release;debugMode=0|DM.debug,debugMode=0|DM.demo;var debugSwitcher=DS.NONE;switch(debugMode){case DM.debug:debugSwitcher=DS.debug_button_group|DS.cloudy_motion2|DS.car_rotation|DS.debug_item_show|DS.debug_draw_area|DS.skip_countdown|DS.fake_number|DS.show_status;break;case DM.demo:debugSwitcher=DS.debug_button_group|DS.cloudy_motion2|DS.car_rotation|DS.fake_number;break;case DM.release:default:debugSwitcher=DS.NONE|DS.cloudy_motion2|DS.car_rotation}var ItemType;!function(e){e[e.NONE=0]="NONE",e[e.chest_START=1]="chest_START",e[e.chest_red_clearly=2]="chest_red_clearly",e[e.chest_green_addHp=3]="chest_green_addHp",e[e.chest_orange_easyGetChest=4]="chest_orange_easyGetChest",e[e.chest_yellow_speedon_invincible=5]="chest_yellow_speedon_invincible",e[e.chest_blue_all_effect=6]="chest_blue_all_effect",e[e.chest_purple_secret=7]="chest_purple_secret",e[e.chest_tree=8]="chest_tree",e[e.chest_girl=9]="chest_girl",e[e.chest_END=10]="chest_END",e[e.trap_START=11]="trap_START",e[e.hole1=12]="hole1",e[e.well1=13]="well1",e[e.water1=14]="water1",e[e.trap_END=15]="trap_END",e[e.coin=16]="coin",e[e.plane1=17]="plane1",e[e.plane2=18]="plane2",e[e.globalPlanet=19]="globalPlanet",e[e.whale=20]="whale",e[e.pop_blue=21]="pop_blue",e[e.pop_green=22]="pop_green",e[e.pop_yellow=23]="pop_yellow",e[e.pop_red=24]="pop_red",e[e.pop_orange=25]="pop_orange",e[e.pop_purple=26]="pop_purple",e[e.pop_tree=27]="pop_tree",e[e.pop_girl=28]="pop_girl",e[e.glassRoad=29]="glassRoad",e[e.cloud=30]="cloud",e[e.fog=31]="fog",e[e.button=32]="button",e[e.sfx_car_moving=33]="sfx_car_moving",e[e.sfx_gameover=34]="sfx_gameover",e[e.bgm=35]="bgm",e[e.sfx_absorb=36]="sfx_absorb"}(ItemType||(ItemType={}));var ItemPosition;!function(e){e[e.NONE=0]="NONE",e[e.left=1]="left",e[e.lm_center=2]="lm_center",e[e.middle=3]="middle",e[e.mr_center=4]="mr_center",e[e.right=5]="right",e[e.top_down_randomV=6]="top_down_randomV",e[e.pot_random=7]="pot_random",e[e.pot3_random=8]="pot3_random",e[e.pot2middle_random=9]="pot2middle_random",e[e.ship_leftToRight=10]="ship_leftToRight",e[e.ship_rightToLeft=11]="ship_rightToLeft",e[e.globalPlanet=12]="globalPlanet",e[e.whalePot=13]="whalePot",e[e.popScale=14]="popScale",e[e.glassRoad=15]="glassRoad",e[e.cloud_random=16]="cloud_random",e[e.cloudPos_left=17]="cloudPos_left",e[e.cloudPos_right=18]="cloudPos_right",e[e.cloudPos_around=19]="cloudPos_around",e[e.fog=20]="fog"}(ItemPosition||(ItemPosition={}));var AnimationName;!function(e){e[e.coin=0]="coin",e[e.plane1=1]="plane1",e[e.plane2=2]="plane2",e[e.globalPlanet=3]="globalPlanet",e[e.whale=4]="whale"}(AnimationName||(AnimationName={}));var CarStatus;!function(e){e[e.NONE=0]="NONE",e[e.invincible=1]="invincible",e[e.gameover=2]="gameover",e[e.absorb=4]="absorb",e[e.glassroad_ready=8]="glassroad_ready",e[e.glassroad_show=16]="glassroad_show"}(CarStatus||(CarStatus={}));var board_end=function(e){function t(){var t=e.call(this)||this;return t.bts=[],t.num_rank=1e4,t.num_km=0,t.skinName="resource/ui/board_end.exml",Notify.One().add(NotifyName.game_score_rank,t.onNtf,t),t}return __extends(t,e),t.prototype.onNtf=function(e){var t=this;switch(e.name){case NotifyName.game_score_rank:egret.Tween.get(this,{onChange:function(){return t.num_rank>=1e4?void(t.txt_rank.text="????"):void(t.txt_rank.text=Math.round(t.num_rank).toString())},onChangeObj:this}).wait(500).to({num_rank:Network.One.data_score_rank.Rank},600,egret.Ease.cubicInOut),this.rank_title.visible=!0,this.rank_title.texture=RES.getRes(Conf.One.rank_res(parseInt(Network.One.data_score_rank.Rank))),egret.Tween.get(this.mark).wait(500).set({visible:!0,scaleX:1.5,scaleY:1.5}).to({scaleX:1,scaleY:1},250,egret.Ease.cubicIn)}},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.mark.visible=!1,this.rank_title.visible=!1,Conf.One.play_snd(ItemType.sfx_gameover),this.bts=[this.bt_close,this.bt_rank,this.bt_revivo,this.bt_bonus],this.txt_km.text="0",this.txt_rank.text="????",DEBUGME(DS.fake_number)&&(Conf.One.gameinfo.score=1e3),egret.Tween.get(this,{onChange:function(){t.txt_km.text=Math.round(t.num_km).toString()},onChangeObj:this}).to({num_km:Conf.One.gameinfo.score},800,egret.Ease.cubicInOut),this.bt_close.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),t.killMe()},this),this.bt_revivo.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button)},this),this.bt_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button)},this),this.bt_bonus.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button)},this),this.bt_replay.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button)},this),Network.One.send_score()},t.prototype.killMe=function(){for(var t=this,s=0;s<this.bts.length;s++)this.bts[s].touchEnabled=!1;egret.Tween.removeTweens(this.ly_board),egret.Tween.get(this.ly_board).to({scaleX:1,scaleY:1},200,egret.Ease.backIn).call(function(){e.prototype.killMe.call(t)},this)},t}(BoardCore);__reflect(board_end.prototype,"board_end");var board_help=function(e){function t(){var t=e.call(this)||this;return t.bts=[],t.sub2_cur=1,t.sub2_max=11,t.skinName="resource/ui/board_help.exml",t}return __extends(t,e),t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.bts.push(this.bt_skip),this.bts.push(this.bt_1_next),this.bts.push(this.bt_2_prev),this.bts.push(this.bt_2_next),this.bts.push(this.bt_sub2_prev),this.bts.push(this.bt_sub2_next),this.bts.push(this.bt_3_startgame),this.ly1.visible=!0,this.ly2.visible=!1,this.ly3.visible=!1,this.mov_sub1.play(0),this.mov_sub1.addEventListener(egret.Event.COMPLETE,function(){t.mov_sub1.play(0)},this),this.bt_skip.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),e.prototype.killMe.call(t)},this),this.bt_1_next.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),t.ly1.visible=!1,t.ly2.visible=!0,t.ly3.visible=!1},this),this.bt_2_prev.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),t.ly1.visible=!0,t.ly2.visible=!1,t.ly3.visible=!1},this),this.bt_2_next.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),t.ly1.visible=!1,t.ly2.visible=!1,t.ly3.visible=!0},this),this.bt_3_startgame.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),t.killMe()},this),this.bt_sub2_prev.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),egret.Tween.get(t.sub2_content).to({alpha:0,horizontalCenter:20},80).call(function(){t.sub2_cur--,t.sub2_cur<1&&(t.sub2_cur=t.sub2_max),t.sub2_content.texture=RES.getRes("res01_json.board_help_2_info_"+t.sub2_cur)},t).set({horizontalCenter:-20}).to({alpha:1,horizontalCenter:0},80)},this),this.bt_sub2_next.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),egret.Tween.get(t.sub2_content).to({alpha:0,horizontalCenter:-20},80).call(function(){t.sub2_cur++,t.sub2_cur>t.sub2_max&&(t.sub2_cur=1),t.sub2_content.texture=RES.getRes("res01_json.board_help_2_info_"+t.sub2_cur)},t).set({horizontalCenter:20}).to({alpha:1,horizontalCenter:0},80)},this)},t.prototype.killMe=function(){for(var t=this,s=0;s<this.bts.length;s++)this.bts[s].touchEnabled=!1;egret.Tween.removeTweens(this.ly_board),egret.Tween.get(this.ly_board).to({scaleX:1,scaleY:1},200,egret.Ease.backIn).call(function(){e.prototype.killMe.call(t)},this)},t}(BoardCore);__reflect(board_help.prototype,"board_help");var board_start=function(e){function t(){var t=e.call(this)||this;return t.scale_def=2,t.skinName="resource/ui/board_start.exml",t}return __extends(t,e),t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){var t=this;e.prototype.childrenCreated.call(this),this.bt_start.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),t.killMe()},this),this.bt_bonus.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),Network.One.getUrl("/bonus_page")},this),this.bt_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Conf.One.play_snd(ItemType.button),Network.One.getUrl("/rank_page")},this),egret.Tween.get(this.ly_board).set({scaleX:1,scaleY:1}).to({scaleX:this.scale_def,scaleY:this.scale_def},400,egret.Ease.sineOut)},t.prototype.killMe=function(){var t=this;this.bt_start.touchEnabled=!1,this.bt_bonus.touchEnabled=!1,this.bt_rank.touchEnabled=!1,egret.Tween.removeTweens(this.ly_board),egret.Tween.get(this.ly_board).to({scaleX:1,scaleY:1},200,egret.Ease.backIn).call(function(){e.prototype.killMe.call(t)},this)},t}(BoardCore);__reflect(board_start.prototype,"board_start");var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return s.sent(),[4,this.loadTheme()];case 2:return s.sent(),[4,RES.loadGroup("preload",0,e)];case 3:return s.sent(),this.stage.removeChild(e),[3,5];case 4:return t=s.sent(),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,s){var o=new eui.Theme("resource/default.thm.json",e.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){egret.Ticker.getInstance().register(function(e){dragonBones.WorldClock.clock.advanceTime(e/1e3)},this),Conf.One.reset(this.stage);var e=new ui_road;this.addChild(e)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var ui_road=function(e){function t(){var t=e.call(this)||this;return t.p_old={x:0,y:0},t.p_down=0,t.p_car={x:0,y:0},t.p_threshold=20,t.item_distance_cur=0,t.km_old=-1,t.skinName="resource/ui/ui_road.exml",Notify.One().add(NotifyName.car_eated,t.onNtf,t),Notify.One().add(NotifyName.car_hp_change,t.onNtf,t),Notify.One().add(NotifyName.car_speed_slowdown,t.onNtf,t),Notify.One().add(NotifyName.game_ready,t.onNtf,t),Notify.One().add(NotifyName.game_end,t.onNtf,t),Notify.One().add(NotifyName.board_closed,t.onNtf,t),Notify.One().add(NotifyName.game_start,t.onNtf,t),Notify.One().add(NotifyName.game_revive,t.onNtf,t),Notify.One().add(NotifyName.game_countdown,t.onNtf,t),t}return __extends(t,e),t.prototype.reset=function(){egret.Tween.TIMESCALE=Conf.One.tween_timescale.slow,this.ly_fog.visible=!1,this.ly_road_speedup.visible=!1,this.txt_hp.text=Conf.One.info_ph.toString(),this.txt_distance.text="0",this.ly_txtCoinCount.visible=!1,this.txtCoinCount.text="0",this.ly_blocks.visible=!1,this.mcDetectTarget.alpha=0,this.mcAbsorbTarget.alpha=0,this.road_masker.alpha=0,this.ly_pop_km.visible=!1,this.ly_board.visible=!1,Conf.One.info_km_pos={x:this.ly_pop_km.horizontalCenter,y:this.ly_pop_km.bottom},e.prototype.reset.call(this)},t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.reset(),this.mov_road_def.addEventListener("complete",this.onTweenGroupComplete,this),this.mov_car1.addEventListener("complete",this.onTweenGroupComplete,this),this.mov_car2.addEventListener("complete",this.onTweenGroupComplete,this),this.addEventListener("touchBegin",this.onTBegin,this),this.addEventListener("touchMove",this.onTMove,this),this.addEventListener("touchEnd",this.onTEnd,this),this.addEventListener(egret.Event.ENTER_FRAME,this.game_update,this),Conf.One.is_game_end=!0,this.create_cloudy_motion(),this.show_sub_board()},t.prototype.show_sub_board=function(){var e;DEBUGME(DS.show_board_start)&&(e=new board_start,this.ly_board.addChild(e),this.ly_board.visible=!0),DEBUGME(DS.show_board_help)&&(e=new board_help,this.ly_board.addChild(e),this.ly_board.visible=!0),DEBUGME(DS.show_board_end)&&(e=new board_end,this.ly_board.addChild(e),this.ly_board.visible=!0)},t.prototype.start_play=function(){Network.One.start_game()},t.prototype.start_play_real=function(){Conf.One.create_stage_level(),egret.Tween.removeTweens(egret.Tween),egret.Tween.get(egret.Tween).set({TIMESCALE:Conf.One.tween_timescale.slow}).to({TIMESCALE:Conf.One.tween_timescale["default"]},800),Conf.One.play_snd(ItemType.bgm,!0),Conf.One.play_snd(ItemType.sfx_car_moving,!0),Conf.One.is_game_end=!1,this.mov_road_def.play(0)},t.prototype.game_update=function(e){if(!Conf.One.is_game_end&&this.status!=CarStatus.gameover){DEBUGME(DS.show_status)&&(this.txt_status.text="m:"+this.status+",s:"+this.status_sub),Conf.One.score_addition(),this.txt_hp.text=Math.round(Conf.One.info_ph).toString(),this.txt_distance.text=Math.round(Conf.One.gameinfo.score).toString(),this.item_distance_cur++;var t=(egret.Tween.TIMESCALE-Conf.One.tween_timescale["default"])/(Conf.One.tween_timescale.speedup-Conf.One.tween_timescale["default"]),s=.5*(this.status_sub&CarStatus.absorb?1:0);Math.floor(Conf.One.item_distance*(3-t-s)/3);if(this.km_old!=Conf.One.gameinfo.score){this.km_old=Conf.One.gameinfo.score;var o=Conf.One.level_unit_on_km(Conf.One.gameinfo.score);switch(o){case ItemType.chest_red_clearly:this.motion_chest(o,ItemPosition.middle);break;case ItemType.chest_yellow_speedon_invincible:case ItemType.chest_blue_all_effect:case ItemType.chest_orange_easyGetChest:case ItemType.chest_green_addHp:case ItemType.chest_purple_secret:case ItemType.chest_girl:case ItemType.chest_tree:this.motion_chest(o,ItemPosition.pot3_random);break;case ItemType.water1:case ItemType.well1:case ItemType.hole1:var a=Math.random();(0==(this.status_sub&CarStatus.glassroad_ready)||a>.7&&this.status_sub&CarStatus.absorb)&&this.create_trap(o)}Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget})}var i=Math.floor((Conf.One.gameinfo.score+10)/100),n=Math.floor(Conf.One.gameinfo.score/75),r=Math.floor(Conf.One.gameinfo.score/24);if(i!=Conf.One.gameinfo.checkpoint&&(Conf.One.gameinfo.checkpoint=i,this.create_glassRoad()),n!=Conf.One.gameinfo.checkpoint_mov)switch(Conf.One.gameinfo.checkpoint_mov=n,Conf.One.next_rand_anm_seed()){case 0:this.create_whale();break;case 1:this.create_shipWar()}r!=Conf.One.gameinfo.checkpoint_fog&&(Conf.One.gameinfo.checkpoint_fog=r,this.create_fog())}},t.prototype.onTBegin=function(e){(!Conf.One.is_game_end||DEBUGME(DS.debug_move))&&(this.p_down=1,this.p_old.x=e.stageX,this.p_old.y=e.stageY,this.p_car.x=this.ly_car.x,this.p_car.y=this.ly_car.y)},t.prototype.onTMove=function(e){if((!Conf.One.is_game_end||DEBUGME(DS.debug_move))&&this.p_down>0){this.p_down=2;var t=e.stageX-this.p_old.x;this.is_car_turning||(t>this.p_threshold?this.is_car_turning=!0:t<-this.p_threshold&&(this.is_car_turning=!0)),DEBUGME(DS.car_rotation)&&(this.car.rotation=-(this.ly_car.x-this.stage.stageWidth/2)/50);var s=.5;this.p_car.x+t/s<Conf.One.range_car_move.x?this.ly_car.x=Conf.One.range_car_move.x:this.p_car.x+t/s>Conf.One.range_car_move.width?this.ly_car.x=Conf.One.range_car_move.width:this.ly_car.x=this.p_car.x+t/s,Notify.One().post(NotifyName.car_moving,{target:this.mcDetectTarget})}},t.prototype.onTEnd=function(e){this.p_down=0},t.prototype.game_end=function(){this.stop_cloudy(),this.removeEventListener(egret.Event.ENTER_FRAME,this.game_update,this),this.status=CarStatus.gameover,Conf.One.is_game_end=!0,this.mov_road_def.stop();var e=new board_end;this.ly_board.addChild(e),this.ly_board.visible=!0,this.ly_pots_trap.removeChildren()},t.prototype.onNtf=function(e){var t=this;switch(e.name){case NotifyName.car_eated:if(e.userdata.type>ItemType.chest_START&&e.userdata.type<ItemType.chest_END&&this.create_popInfo(e.userdata.type),this.status==CarStatus.gameover)return;switch(e.userdata.type){case ItemType.hole1:case ItemType.well1:if(this.status==CarStatus.invincible||this.status_sub&CarStatus.glassroad_show)return;Conf.One.play_snd(e.userdata.type),e.userdata.type==ItemType.hole1?Conf.One.gameinfo.trap_hole+=1:Conf.One.gameinfo.trap_well+=1,this.create_info_km(-60);break;case ItemType.water1:if(this.status==CarStatus.invincible||this.status_sub&CarStatus.glassroad_show)return;Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.trap_water+=1,this.create_visionBlock();break;case ItemType.coin:Conf.One.Coin_Collect_Total++,egret.Tween.removeTweens(this.ly_txtCoinCount),this.ly_txtCoinCount.visible=!0,egret.Tween.get(this.ly_txtCoinCount).wait(1e3).set({visible:!1}),this.txtCoinCount.text=Conf.One.Coin_Collect_Total.toString();break;case ItemType.chest_red_clearly:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.red+=1,this.car_toClearly(),this.play_effect(e.userdata.type);break;case ItemType.chest_green_addHp:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.green+=1,this.create_info_km(50),this.play_effect(e.userdata.type);break;case ItemType.chest_orange_easyGetChest:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.orange+=1,this.absorb_chest(5),this.play_effect(e.userdata.type,!0,5);break;case ItemType.chest_yellow_speedon_invincible:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.yellow+=1,this.speedUp(5),this.play_effect(e.userdata.type,!0,5);break;case ItemType.chest_blue_all_effect:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.blue+=1,this.car_toClearly(),this.create_info_km(50),this.speedUp(5),this.absorb_chest(5),this.play_effect(e.userdata.type,!0,5);break;case ItemType.chest_purple_secret:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.secret+=1,Conf.One.set_chest_got(e.userdata.type),this.play_effect(e.userdata.type);break;case ItemType.chest_girl:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.girl+=1,Conf.One.set_chest_got(e.userdata.type),this.play_effect(e.userdata.type);break;case ItemType.chest_tree:Conf.One.play_snd(e.userdata.type),Conf.One.gameinfo.tree+=1,Conf.One.set_chest_got(e.userdata.type),this.play_effect(e.userdata.type)}break;case NotifyName.car_hp_change:Conf.One.score_reduce(-e.userdata.value),this.txt_hp.text=Conf.One.info_ph.toString();break;case NotifyName.car_speed_slowdown:if(this.status==CarStatus.gameover)return;egret.Tween.TIMESCALE=Conf.One.tween_timescale.trap,setInterval(function(){t.status!=CarStatus.invincible&&(egret.Tween.TIMESCALE=Conf.One.tween_timescale["default"])},800);break;case NotifyName.game_ready:Conf.One.play_snd(ItemType.button),Conf.One.is_game_end&&this.start_play();break;case NotifyName.game_countdown:this.mov_countdown();break;case NotifyName.game_start:this.start_play_real();break;case NotifyName.game_revive:this.start_play_real();break;case NotifyName.game_end:Conf.One.stop_snd(ItemType.sfx_car_moving),this.game_end();break;case NotifyName.board_closed:Conf.One.play_snd(ItemType.button),this.ly_board.visible=!1}},t}(ui_road_def);__reflect(ui_road.prototype,"ui_road");var ui_test=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/ui/ui_test.exml",t}return __extends(t,e),t.prototype.partAdded=function(t,s){e.prototype.partAdded.call(this,t,s)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.motion_chest(ItemType.chest_red_clearly,ItemPosition.left)},t.prototype.motion_chest=function(e,t){var s=null;switch(e){case ItemType.chest_red_clearly:s=RES.getRes("res01_json.chest_red");break;default:s=RES.getRes("res01_json.chest_red")}var o=new egret.Bitmap(s);this.addChild(o)},t}(eui.Component);__reflect(ui_test.prototype,"ui_test",["eui.UIComponent","egret.DisplayObject"]);var Item=function(e){function t(){var t=e.call(this)||this;return t.isAnimation=!1,t.isDetected=!1,t.isDestroyed=!1,t.addEventListener(egret.Event.REMOVED,t.killMe,t),t}return __extends(t,e),t.prototype.reset=function(e,t){void 0===t&&(t=100),this.isAnimation=!1,this.type=e;var s=null;switch(this.name="Item_"+e.toString(),e){case ItemType.coin:this.anm=Conf.One.anm_load(AnimationName.coin,200*Math.random()),this.isAnimation=!0,this.anm.rotation=100*Math.random()-50;break;case ItemType.plane1:this.anm=Conf.One.anm_load(AnimationName.plane1),this.isAnimation=!0;break;case ItemType.plane2:this.anm=Conf.One.anm_load(AnimationName.plane2),this.isAnimation=!0;break;case ItemType.globalPlanet:this.anm=Conf.One.anm_load(AnimationName.globalPlanet),this.isAnimation=!0;break;case ItemType.whale:this.anm=Conf.One.anm_load(AnimationName.whale),this.isAnimation=!0;break;default:s=Conf.One.res_load(e),null==s&&console.warn("error type:"+e)}return this.isAnimation?this.addChild(this.anm):(this.img=new egret.Bitmap,this.type==ItemType.fog&&(this.img.alpha=.85),this.addChild(this.img),this.img.texture=s),this
},t.prototype.motion=function(e,t,s,o){void 0===s&&(s=1),void 0===o&&(o=1);var a=this.isAnimation?this.anm:this.img,i=5e3,n=1,r=.1,_=s;switch(this.type){case ItemType.plane1:case ItemType.plane2:_=2;break;case ItemType.globalPlanet:_=2,i=5e4;break;case ItemType.coin:_=1.15,i=3e3,this.isDetected=!0;break;case ItemType.whale:_=2}if(this.isAnimation)i*=o,a.x=e.x-a.width/2,a.y=e.y-a.height/2,a.scaleX=a.scaleY=e.scaleX*_,e==t?(a.alpha=0,egret.Tween.get(a).to({alpha:1},500).wait(4*i).call(this.onTwCom,this)):egret.Tween.get(a,{onChange:this.onTwChg,onChangeObj:this}).wait(200).to({x:t.x-a.width/2*t.scaleX*_,y:t.y-a.height/2*t.scaleX*_,scaleX:t.scaleX*_,scaleY:t.scaleX*_},i).call(this.onTwCom,this),this.type==ItemType.coin&&DEBUGME(DS.able_eat_coin)&&Notify.One().add(NotifyName.car_moving,this.onNtf,this);else{i=4e3,_=.5;var c=egret.Ease.quartIn;switch(this.type){case ItemType.water1:_=1;break;case ItemType.well1:_=.9;break;case ItemType.hole1:_=.9;break;case ItemType.chest_red_clearly:case ItemType.chest_yellow_speedon_invincible:case ItemType.chest_orange_easyGetChest:case ItemType.chest_blue_all_effect:case ItemType.chest_green_addHp:case ItemType.chest_purple_secret:case ItemType.chest_girl:case ItemType.chest_tree:_=1.25;break;case ItemType.glassRoad:_=2,i=4e3;break;case ItemType.cloud:i=2e4,c=egret.Ease.sineIn,_=2;break;case ItemType.fog:n=.3,r=.6,egret.Tween.get(a).wait(i*o-500).to({alpha:0},500);break;default:_=1}switch(this.type){case ItemType.pop_blue:case ItemType.pop_green:case ItemType.pop_yellow:case ItemType.pop_orange:case ItemType.pop_red:case ItemType.pop_purple:case ItemType.pop_tree:case ItemType.pop_girl:return i=4e3,i*=o,a.x=e.x,a.y=e.y,a.scaleX=a.scaleY=.01,a.alpha=1,egret.Tween.get(a).wait(i+400).to({alpha:0},200),void egret.Tween.get(a).to({x:t.x,y:t.y,scaleX:t.scaleX,scaleY:t.scaleX},400,egret.Ease.backOut).wait(i).to({x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleX},400,egret.Ease.backIn).call(this.onTwCom,this)}switch(a.scaleX=a.scaleY=e.scaleX*_*r,a.x=e.x-a.width/2*a.scaleX,a.y=e.y-a.height/2*a.scaleX,a.alpha=0,i*=o,egret.Tween.get(a).to({alpha:n},500),egret.Tween.get(a).to({scaleX:t.scaleX*_,scaleY:t.scaleX*_},i,c),egret.Tween.get(a,{onChange:this.onTwChg,onChangeObj:this}).to({x:t.x-a.width/2*t.scaleX*_,y:t.y-a.height/2*t.scaleX*_},i,c).call(this.onTwCom,this),this.type){case ItemType.glassRoad:break;default:Notify.One().add(NotifyName.car_moving,this.onNtf,this)}}},t.prototype.onTwChg=function(e){if(!this.isDetected){var t=this.isAnimation?this.anm:this.img;if(this.isAnimation){if(this.detectTarget){var s=this.detectTarget.localToGlobal(0,0),o=new egret.Rectangle(s.x,s.y,this.detectTarget.width,this.detectTarget.height),a=t.localToGlobal(0,0);o.containsPoint(a)&&(Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0,this.killMe())}}else{if(this.absorbTarget&&Conf.One.car_status_sub&CarStatus.absorb){var s=this.absorbTarget.localToGlobal(0,0),o=new egret.Rectangle(s.x-2*this.stage.stageWidth,s.y-this.absorbTarget.height/2,5*this.stage.stageWidth,this.absorbTarget.height),a=t.localToGlobal(0,0),i=20,n=new egret.Rectangle(a.x+i,a.y+i,t.width*t.scaleX-2*i,t.height*t.scaleX-2*i);if(Conf.One.hitRect(o,n)&&this.type>ItemType.chest_START&&this.type<ItemType.chest_END)return Conf.One.play_snd(ItemType.sfx_absorb),Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0,egret.Tween.removeTweens(t),void egret.Tween.get(t).to({x:s.x,y:s.y,scaleX:.1,scaleY:.1},1e3).call(this.killMe,this)}if(this.detectTarget){var s=this.detectTarget.localToGlobal(0,0),o=new egret.Rectangle(s.x,s.y,this.detectTarget.width,this.detectTarget.height),a=t.localToGlobal(0,0),i=100,n=new egret.Rectangle(a.x+i,a.y+i,t.width*t.scaleX-2*i,t.height*t.scaleX-2*i);if(DEBUGME(DS.debug_draw_area)&&(this.graphics.clear(),this.graphics.beginFill(16711680,.8),this.graphics.drawRect(n.x,n.y,n.width,n.height),this.graphics.endFill()),Conf.One.hitRect(o,n))switch(this.type){case ItemType.hole1:case ItemType.water1:case ItemType.well1:Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0;break;default:Notify.One().post(NotifyName.car_eated,{type:this.type}),this.isDetected=!0,this.killMe()}}}}},t.prototype.fadeOutMe=function(){var e=this.isAnimation?this.anm:this.img;egret.Tween.removeTweens(e),egret.Tween.get(e).to({alpha:0},150).call(this.killMe,this)},t.prototype.stopMe=function(){var e=this.isAnimation?this.anm:this.img;egret.Tween.removeTweens(e)},t.prototype.killMe=function(){if(!this.isDestroyed){this.isDestroyed=!0,this.absorbTarget=null,this.detectTarget=null;var e=this.isAnimation?this.anm:this.img;egret.Tween.removeTweens(e),Notify.One().removeTarget(this),this.mask&&(this.mask.parent.removeChild(this.mask),this.mask=null),this.parent&&this.parent.removeChild(this)}},t.prototype.onTwCom=function(e){this.killMe()},t.prototype.onNtf=function(e){switch(e.name){case NotifyName.car_moving:this.type>ItemType.chest_START&&this.type<ItemType.trap_END&&(this.detectTarget=e.userdata.target),this.type>ItemType.chest_START&&this.type<ItemType.chest_END&&(this.absorbTarget=e.userdata.target)}},t}(egret.Sprite);__reflect(Item.prototype,"Item");